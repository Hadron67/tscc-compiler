!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.jscc={})}(this,function(t){"use strict";var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function n(t,n){e(t,n);function r(){this.constructor=t}t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=32,a=function(){function t(t){this._size=t,this._s=new Array(Math.ceil(t/r));for(var e=0;e<this._s.length;e++)this._s[e]=0}return t.prototype.add=function(t){var e=Math.floor(t/r),n=t-e*r,a=this._s[e];return this._s[e]|=1<<n,a!==this._s[e]},t.prototype.addAll=function(){for(var t=0;t<this._s.length;t++)this._s[t]=-1},t.prototype.remove=function(t){var e=Math.floor(t/r),n=t-e*r,a=this._s[e];return this._s[e]&=~(1<<n),a!==this._s[e]},t.prototype.removeAll=function(){for(var t=0;t<this._s.length;t++)this._s[t]=0},t.prototype.contains=function(t){var e=Math.floor(t/r),n=t-e*r;return 0!=(this._s[e]&1<<n)},t.prototype.union=function(t,e){for(var n=!1,r=0;r<this._s.length;r++){var a=this._s[r],s=t._s[r];e&&(s&=e._s[r]),this._s[r]|=s,n=this._s[r]!==a||n}return n},t.prototype.hasIntersection=function(t){for(var e=0;e<this._s.length;e++)if(0!=(this._s[e]&t._s[e]))return!0;return!1},t.prototype.equals=function(t){for(var e=0;e<this._s.length;e++)if(this._s[e]!==t._s[e])return!1;return!0},t.prototype.forEach=function(t){for(var e=0;e<this._size;e++)this.contains(e)&&t(e)},t.prototype.hash=function(){for(var t="",e=0;e<this._s.length;e++)t+=this._s[e].toString(16)+"-";return t},t}(),s="    ",i={assert:function(t){if(!t)throw new Error("Assertion failed")},log:function(t){}};function o(t,e){return t===u.oo&&e!==u.oo||t!==u._oo&&e===u._oo||t>e?1:t===u._oo&&e!==u._oo||t!==u.oo&&e===u.oo||t<e?-1:0}var u;(c=u||(u={})).oo="oo",c._oo="-oo";var c,l=function(){function t(t,e){this.dataSet=null,this.a=t,this.b=e}return t.prototype.insertBefore=function(t,e,n){if(this.parent.isValid(this)&&!this.parent.noMerge&&this.a===e+1)return this.a=t,this;var r=this.parent.createInterval(t,e,n);return r.prev=this.prev,r.next=this,this.prev.next=r,this.prev=r,r},t.prototype.contains=function(t){return o(this.a,t)<=0&&o(this.b,t)>=0},t.prototype.overlaps=function(t,e){return!(o(t,this.b)>0||o(e,this.a)<0)},t.prototype.insertAfter=function(t,e,n){if(this.parent.isValid(this)&&!this.parent.noMerge&&this.b===t-1)return this.b=e,this;var r=this.parent.createInterval(t,e,n);return r.prev=this,r.next=this.next,this.next.prev=r,this.next=r,r},t.prototype.splitLeft=function(t){if(o(t,this.a)>0){var e=this.insertBefore(this.a,t-1);return this.parent.noMerge&&e.dataSet.union(this.dataSet),this.a=t,e}return this},t.prototype.splitRight=function(t){if(o(t,this.b)<0){var e=this.insertAfter(t+1,this.b);return this.parent.noMerge&&e.dataSet.union(this.dataSet),this.b=t,e}return this},t.prototype.remove=function(){return this.prev.next=this.next,this.next.prev=this.prev,this},t.prototype.checkMerge=function(){return this.a!==u._oo&&null!==this.prev.a&&this.a===this.prev.b+1&&(this.a=this.prev.a,this.prev.remove()),this.b!==u.oo&&null!==this.next.a&&this.b===this.next.a-1&&(this.b=this.next.b,this.next.remove()),this},t.prototype.toString=function(t){var e="";function n(t){return t===u.oo?"+oo":t===u._oo?"-oo":t.toString()}var r=(t||n)(this.a),a=(t||n)(this.b);return this.a===this.b?e+=r:(e+=this.a===u._oo?"("+r:"["+r,e+=",",e+=this.b===u.oo?a+")":a+"]"),this.dataSet&&(e+=this.dataSet.toString()),e},t}();function h(t,e){if(o(t,e)>0)throw new Error('illegal argument: "a"('+t+') must be no more than "b"('+e+")")}var f=function(){function t(t){this.head=new l(0,0),this.head.parent=this,this.tail=new l(null,null),this.tail.parent=this,this.head.next=this.tail,this.tail.prev=this.head,this.noMerge=void 0!==t,this.dataSetConstructor=t||null}return t.prototype.isValid=function(t){return t!==this.head&&t!==this.tail},t.prototype.createInterval=function(t,e,n){void 0===n&&(n=null);var r=new l(t,e);return r.parent=this,this.dataSetConstructor&&(r.dataSet=this.dataSetConstructor()),n&&r.dataSet.add(n),r},t.prototype.fitPoint=function(t,e){for(var n=this.head;n!==this.tail;n=n.next)if((n===this.head||o(t,n.b)>0)&&(n.next===this.tail||o(e,n.next.a)<0))return n;return null},t.prototype.overlaped=function(t,e){for(var n=null,r=null,a=this.head.next;a!==this.tail&&!a.overlaps(t,e);a=a.next);if(a===this.tail)return null;for(n=r=a;a!==this.tail&&a.overlaps(t,e);a=a.next)r=a;return[n,r]},t.prototype.add=function(t,e,n){void 0===e&&(e=t);var r=this.noMerge;h(t,e);var a=this.overlaped(t,e);if(null===a)this.fitPoint(t,e).insertAfter(t,e,n);else if(r){a[0].contains(t)?a[0].splitLeft(t):a[0].insertBefore(t,a[0].a-1,n),a[1].contains(e)?a[1].splitRight(e):a[1].insertAfter(a[1].b+1,e,n);for(var s=a[0];s!==a[1];s=s.next)s.dataSet.add(n),s.b+1<s.next.a&&s.insertAfter(s.b+1,s.next.a-1,n);a[1].dataSet.add(n)}else{var i=o(t,a[0].a)<0?t:a[0].a,u=o(e,a[1].b)>0?e:a[1].b;a[0].a=i,a[0].b=u,a[0].next=a[1].next,a[1].next.prev=a[0],a[0].checkMerge()}return this},t.prototype.remove=function(t,e){h(t,e);var n=this.overlaped(t,e);return null!==n&&(n[0].contains(t)&&n[0].splitLeft(t),n[1].contains(e)&&n[1].splitRight(e),n[0].prev.next=n[1].next,n[1].next.prev=n[0].prev),this},t.prototype.removeAll=function(){return this.head.next=this.tail,this.tail.prev=this.head,this},t.prototype.forEach=function(t){for(var e=this.head.next;e!==this.tail;e=e.next)t(e.a,e.b,e);return this},t.prototype.union=function(t){for(var e=t.head.next;e!==t.tail;e=e.next)this.add(e.a,e.b);return this},t.prototype.contains=function(t){for(var e=this.head.next;e!==this.tail;e=e.next)if(e.contains(t))return!0;return!1},t.prototype.toString=function(t){for(var e="",n=!1,r=this.head.next;r!==this.tail;r=r.next)n&&(e+=","),n=!0,e+=r.toString(t);return""===e?"phi":e},t}(),d=u.oo,p=u._oo,v=function(t){n(e,t);function e(e){return t.call(this,e)||this}return e.prototype.addAll=function(){t.prototype.add.call(this,0,u.oo)},e.prototype.constainsAll=function(){var t=this.head.next;return t.next===this.tail&&0===t.a&&t.b===d},e.prototype.toString=function(){return t.prototype.toString.call(this,function(t){return t!==d&&t!==p?t>=32&&t<=126?"'"+String.fromCharCode(t)+"'":"\\x"+t.toString(16):t===d?"oo":"-oo"})},e}(f),g="\n",k=function(){function t(){}return t.prototype.writeln=function(t){t&&this.write(t),this.write(g)},t}(),m=function(t){n(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.s="",e}return e.prototype.write=function(t){this.s+=t},e.prototype.reset=function(){this.s=""},e}(k);function b(t){var e=[];return{peek:function(){return e.length>0?e[e.length-1]:t.peek()},next:function(){return e.length>0?e.pop():t.next()},backup:function(t){e.push(t)}}}var E,_=Object.freeze({endl:g,OutputStream:k,StringOS:m,StringIS:function(t){var e=0;return{peek:function(){return t.charAt(e)||null},next:function(){var t=this.peek();return e++,t}}},biss:b});(A=E||(E={}))[A.START=0]="START",A[A.END=1]="END",A[A.NONE=2]="NONE";var A,x=0,y=function(t){n(e,t);function e(){var n=t.call(this,0)||this;return Object.setPrototypeOf(n,e.prototype),n}return e.prototype.add=function(t){for(var e=0;e<this.length;e++){if(t===this[e])return}this.length>x&&(x=this.length),this.push(t)},e.prototype.union=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];this.add(r)}},e.prototype.toArray=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];t.push(n)}return t},e}(Array),S=function(){return function(t,e){this.chars=new v,this.from=t,this.to=e}}(),w=function(){return function(){this.priority=0,this.id=0,this.data=null}}(),T=function(){function t(t){this.valid=!1,this.arcs=[],this.epsilons=[],this.index=0,this.isStart=!1,this.isEnd=!1,this.marker=!1,this.endAction=null,this.endAction=t||null}return t.prototype.findArc=function(t){for(var e=0,n=this.arcs;e<n.length;e++){var r=n[e];if(r.to===t)return r}return null},t.prototype.to=function(t){var e=this.findArc(t);return null===e&&(e=new S(this,t),this.arcs.push(e)),t.valid=!0,e},t.prototype.epsilonTo=function(t){this.epsilons.push(t)},t.prototype.hasDefinate=function(){return 1===this.arcs.length&&this.arcs[0].chars.constainsAll()},t.prototype.iterator=function(t){void 0===t&&(t=!1);var e=[this],n=[this];return this.marker=!0,function(){if(e.length>0){var r=e.pop();if(!t)for(var a=0,s=r.arcs;a<s.length;a++){var i=s[a].to;i.marker||(e.push(i),n.push(i),i.marker=!0)}for(var o=0,u=r.epsilons;o<u.length;o++){var c=u[o];c.marker||(e.push(c),n.push(c),c.marker=!0)}return r}for(var l=0,h=n;l<h.length;l++){h[l].marker=!1}return null}},t.prototype.forEach=function(t,e){void 0===e&&(e=!1);var n=[this],r=[this];for(this.marker=!0;n.length>0;){var a=n.pop();if(t(a),!e)for(var s=0,i=a.arcs;s<i.length;s++){var o=i[s].to;o.marker||(n.push(o),r.push(o),o.marker=!0)}for(var u=0,c=a.epsilons;u<c.length;u++){var l=c[u];l.marker||(n.push(l),r.push(l),l.marker=!0)}}for(var h=0,f=r;h<f.length;h++){f[h].marker=!1}},t.prototype.number=function(){var t=0;this.forEach(function(e){e.index=t++})},t.prototype.print=function(t,e){void 0===e&&(e=!0);function n(t){var e="";e+="state "+t.index,t.isStart&&(e+="(start)"),t.endAction&&(e+="(end "+t.endAction.id+")"),e+=g;for(var n=0;n<t.arcs.length;n++){var r=t.arcs[n];e+=""+s+r.chars.toString()+" -> state "+r.to.index+g}if(t.epsilons.length>0){e+=s+"epsilon: ";for(n=0;n<t.epsilons.length;n++)n>0&&(e+=","),e+=t.epsilons[n].index.toString();e+=g}return e}e?this.forEach(function(e){t.write(n(e))}):t.write(n(this))},t.prototype.toString=function(t){void 0===t&&(t=!0);var e=new m;return this.print(e,t),e.s},t.prototype.copyEndFrom=function(t){null!==t.endAction&&(null!==this.endAction?this.endAction.priority<t.endAction.priority&&(this.endAction=t.endAction):this.endAction=t.endAction)},t.prototype.removeEpsilons=function(){var t=[this];this.forEach(function(e){e.valid&&t.push(e)});for(var e=0;e<t.length;e++){var n=t[e];n.forEach(function(t){if(t!==n){for(var e=0;e<t.arcs.length;e++){var r=t.arcs[e];n.to(r.to).chars.union(r.chars)}n.copyEndFrom(t)}},!0),n.epsilons.length=0}for(e=0;e<t.length;e++)t[e].index=e},t.prototype.count=function(){var t=0;return this.forEach(function(){t++}),t},t.prototype.size=function(){var t=0;return this.forEach(function(){t++}),t},t.prototype.allChars=function(t){for(var e=0;e<this.arcs.length;e++){var n=this.arcs[e];n.chars.forEach(function(e,r){t.add(e,r,n.to)})}},t.prototype.getState=function(t){for(var e=0;e<this.arcs.length;e++){var n=this.arcs[e];if(n.chars.contains(t))return n.to}return null},t.prototype.hasArc=function(){return this.arcs.length>0},t.prototype.clone=function(){},t.prototype.toDFA=function(){var t={},e=[],n=0,r=this.count(),a=new v(function(){return new y}),s=new C(r,[this]);s.index=n++,e.push(s),t[s.hash()]=s;for(var i=[s];i.length>0;){var o=i.shift();a.removeAll(),o.allChars(a),a.forEach(function(a,s,u){var c=new C(r,u.dataSet.toArray()),l=c.hash();t[l]?c=t[l]:(t[l]=c,i.push(c),c.index=n++,e.push(c)),o.to(c).chars.add(a,s)})}return s.release(),{head:s,states:e}},t}(),C=function(t){n(e,t);function e(e,n){var r=t.call(this)||this;r.isEnd=r.isStart=!1,r.valid=!0,r.states=n,r.stateSet=new a(e);for(var s=0;s<n.length;s++)r.stateSet.add(n[s].index),r.copyEndFrom(n[s]),r.isStart=r.isStart||n[s].isStart;return r}return e.prototype.hash=function(){return this.stateSet.hash()},e.prototype.allChars=function(t){for(var e=0;e<this.states.length;e++)this.states[e].allChars(t)},e.prototype.forEach=function(e){t.prototype.forEach.call(this,e)},e.prototype.release=function(){this.forEach(function(t){t.states.length=0})},e}(T),R=function(){function t(t){this.states=t,this.start=t[0]}return t.prototype.print=function(t){for(var e=0,n=this.states;e<n.length;e++){n[e].print(t,!1),t.writeln()}},t.prototype.toString=function(){for(var t="",e=0;e<this.states.length;e++)t+=this.states[e].toString()+"\n";return t},t.prototype.matcher=function(t){var e,n=b(t),r=[],a=[],s=null,i=n.peek();function o(){null!==s&&r.push(i),a.push(i),n.next(),i=n.peek()}function u(){for(e=s,s=null;r.length>0;)n.backup(r.pop()),a.pop()}var c=this;return function(){i=n.peek(),e=c.start,a.length=0,r.length=0,s=null;for(var t;;)if(null!==e.endAction){if(!e.hasArc())return{matched:a.join(""),action:e.endAction};if(null===(t=null!==i?e.getState(i.charCodeAt(0)):null))return{matched:a.join(""),action:e.endAction};r.length=0,s=e,e=t,o()}else{if(null===(t=null!==i?e.getState(i.charCodeAt(0)):null)){if(null!==s)return u(),{matched:a.join(""),action:e.endAction};if(null===i)return null;throw new Error('unexpected character "'+i+'"')}e=t,o()}}},t}(),L=function(){function t(t,e){void 0===e&&(e="Error"),this.msg=t,this.type=e}return t.prototype.toString=function(t){void 0===t&&(t={});var e=!!t.escape,n=this.type;return t.typeClass&&(n='<span class="'+t.typeClass+'">'+n+"</span>"),n+=": ",n+=e?this.msg.replace(/</g,"&lt").replace(/>/g,"&gt"):this.msg},t}(),N=function(t){n(e,t);function e(e,n){var r=t.call(this,e,"CompilationError")||this;return r.line=n,r}return e.prototype.toString=function(e){return t.prototype.toString.call(this,e)+" (at line "+this.line+")"},e}(L),I=function(t){n(e,t);function e(e){return t.call(this,e,"Warning")||this}return e}(L),D=function(t){n(e,t);function e(e){return t.call(this,e,"PatternException")||this}return e}(L);function O(t,e){var n=[{sptr:0,s:t,name:""}],r=n[0];return{next:function(){r.sptr++,r.sptr>=r.s.length&&(n.length>1&&n.pop(),r=n[n.length-1])},peek:function(){return r.s[r.sptr]||null},pushTo:function(t){var a=e?e[t]:null;if(!a)throw new D('undefined name "'+t+'"');!function(t){for(var e=0;e<n.length;e++)if(n[e].name===t)throw new D('cannot use pattern "'+t+'" which leads to loop reference')}(t),n.push({sptr:0,s:"("+a+")",name:t}),r=n[n.length-1]}}}function U(t,e){void 0===e&&(e={});var n=O(t,e),r=n.peek();function a(){n.next(),r=n.peek()}function s(t){if(null===r)throw new D("unexpected end of string"+(t?", "+t:""))}function i(){return new T}function o(){return null===r}function u(t){if(r!==t)throw new D('unexpected character "'+r+'",expecting "'+t+'"');a()}function c(t){for(var e=l(t);!o()&&"|"===r;){a();var n=i();t.epsilonTo(n),l(n).epsilonTo(e)}return e}function l(t){var e=t;do{e=h(e)}while(!o()&&"|"!==r&&")"!==r);return e}function h(t){var e=i();t.epsilonTo(e);var h=function(t){{if(s(),"("===r){a();var e=c(t);return u(")"),e}if("."===r){a();var e=i();return t.to(e).chars.addAll(),e}if("["===r){a();var h="^"===r;h&&a();var e=i(),p=t.to(e).chars;for(h&&p.addAll();"]"!==r&&!o();)d(p,h);return u("]"),e}if("{"===r){a();for(var v="";"}"!==r;)s(),v+=r,a();return a(),n.pushTo(v),r=n.peek(),l(t)}var e=i();return t.to(e).chars.add(f()),e}}(e);if("*"===r){a(),h.epsilonTo(e);var p=i();return e.epsilonTo(p),p}if("+"===r){a();var v=i();return h.epsilonTo(v),v.epsilonTo(e),v}if("?"===r){a();var g=i();return e.epsilonTo(g),h.epsilonTo(g),g}return h}function f(){if(s(),"\\"===r){a();var t=r.charCodeAt(0);switch(r){case"t":t="\t";case"n":t="\n";case"r":t="\r";case"x":a();for(var e="";null!==r&&/[0-9a-fA-F]/.test(r);)e+=r,a();return parseInt(e,16);default:t=r}return a(),t.charCodeAt(0)}var n=r.charCodeAt(0);return a(),n}function d(t,e){var n=f(),s=n,i=n;if("-"===r&&(a(),(i=f())<s))throw new D('left hand side must be larger than right hand side in wild card character (got "'+s.toString(16)+'" < "'+i.toString(16)+'")');e?t.remove(s,i):t.add(s,i)}var p=i();p.isStart=!0;return{result:p,tail:c(p)}}function F(t){void 0===t&&(t={});var e=[],n=0;var r=new T;return{lexRule:function(a,s,i,o){var u=new w;u.priority=n++,u.id=s,u.data=i||null;var c=o?function(t){var e=0,n=t.charAt(e);function r(){return new T}var a=r();a.isStart=!0;for(var s=a;null!==n;){var i=r();s.to(i).chars.add(n.charCodeAt(0)),s=i,n=t.charAt(++e)||null}return{result:a,tail:s}}(a):U(a,t);c.tail.endAction=u,r.epsilonTo(c.result),e.push(u)},done:function(){r.removeEpsilons();var t=r.toDFA();return new R(t.states)}}}var B,M=Object.freeze({lexer:function(t,e){var n;n="function"!=typeof t?function(){return t.shift()||null}:t;for(var r=F(e),a=n();null!==a;)r.lexRule(a.regexp,a.id,a.data,a.raw),a=n();return r.done()},lexerBuilder:F}),P=function(t){n(e,t);function e(e){return t.call(this,e)||this}return e.prototype.toString=function(t){var e="",n=!0;this.contains(0)&&(e+='""',n=!1);for(var r=0;r<t.tokenCount;r++)this.contains(r+1)&&(n||(e+=","),e+='"'+t.tokens[r].sym+'"',n=!1);return e},e}(a);(V=B||(B={}))[V.NONE=1]="NONE",V[V.SHIFT=2]="SHIFT",V[V.REDUCE=3]="REDUCE";var V,G,H=function(){function t(t,e){this.marker=0,this.shift=null,this.actionType=B.NONE,this.changed=!0,this.rule=t,this.isKernel=e,this.lah=new P(t.g.tokenCount)}return t.prototype.canShift=function(){return this.rule.rhs.length>this.marker},t.prototype.getShift=function(){return this.rule.rhs[this.marker]},t.prototype.toString=function(t){void 0===t&&(t={});var e=t&&t.showlah||!1,n=t&&t.showTrailer||!1,r="[ "+this.rule.toString(this.marker)+(e?",{ "+this.lah.toString(this.rule.g)+" }":"")+" ]";if(this.isKernel&&(r+="*"),n)switch(this.actionType){case B.NONE:r+="(-)";break;case B.SHIFT:r+="(s"+this.shift.stateIndex+")";break;case B.REDUCE:r+="(r)"}return r},t.prototype.hash=function(){return this.rule.index+"-"+this.marker},t.prototype.hasRRConflictWith=function(t){return this.actionType===B.REDUCE&&t.actionType===B.REDUCE&&this.rule.index!==t.rule.index&&this.lah.hasIntersection(t.lah)},t.prototype.getFollowSet=function(t){var e,n=this.rule.g;for(e=this.marker+1;e<this.rule.rhs.length;e++){var r=this.rule.rhs[e];if(n.isToken(r)){t.add(r+1);break}var a=n.nts[-r-1].firstSet;if(t.union(a),t.remove(0),!a.contains(0))break}e===this.rule.rhs.length&&t.union(this.lah)},t.NULL={},t}(),K=function(){function t(t){this.it={},this.complete=!1,this.index=-1,this.stateIndex=0,this.prev=null,this.next=null,this.merges=[],this.g=t,this.data=this}return t.prototype.add=function(t,e,n,r,a){var s=t.index+"-"+e,i=this.it[s];if(void 0===i){var o=new H(t,n);return o.marker=e,r&&o.lah.union(r),this.it[s]=o,!0}if(r){var u=i.lah.union(r);return a&&u&&i.canShift()&&(i.actionType=B.NONE),u&&(i.changed=!0),u}},t.prototype.contains=function(){},t.prototype.closure=function(){for(var t=!0,e=new P(this.g.tokenCount),n=this;t;){t=!1;for(var r in this.it){var a=this.it[r];if(a.changed&&a.canShift()){var s=a.getShift();s<0&&(e.removeAll(),a.getFollowSet(e),this.g.forEachRuleOfNt(-s-1,function(r){return t=n.add(r,0,!1,e,!1)||t,!1}))}a.changed=!1}}},t.prototype.toString=function(t){var e={showTrailer:t&&t.showTrailer||!1},n="s"+this.stateIndex;if(null!==this.index?n+="(i"+this.index:n+="(i?",this.merges.length>0){n+=",merged from ";for(var r=0;r<this.merges.length;r++)r>0&&(n+=","),n+="i"+this.merges[r]}n+=")"+g;for(var a in this.it)n+=this.it[a].toString(e)+g;return n},t.prototype.kernelHash=function(){var t=0;for(var e in this.it){var n=this.it[e];n.isKernel&&(t+=n.rule.index<<5+n.rule.index+n.marker)}return String(t)},t.prototype.forEach=function(t){for(var e in this.it)t(this.it[e])},t.prototype.canMergeTo=function(t){for(var e in this.it){var n=this.it[e],r=!1,a=!1,s=!1;for(var i in t.it){var o=t.it[i];if(n.rule.index===o.rule.index&&n.marker===o.marker&&(s=n.lah.equals(o.lah),r=n.isKernel&&o.isKernel),a=a||n.hasRRConflictWith(o),o.isKernel&&void 0===this.it[i])return!1}if(n.isKernel&&!r||a&&!s)return!1}return!0},t.prototype.mergeTo=function(t){var e=!1;for(var n in t.it){var r=t.it[n];e=this.add(r.rule,r.marker,r.isKernel,r.lah,!0)||e}return this.merges.push(t.index),e},t}(),j=function(){function t(){this.size=0,this.head={prev:null,next:null,data:null},this.tail={prev:null,next:null,data:null},this.head.next=this.tail,this.tail.prev=this.head}return t.prototype.append=function(t){t.prev=this.tail.prev,t.next=this.tail,this.tail.prev.next=t,this.tail.prev=t,this.size++},t.prototype.pull=function(){var t=this.head.next;return this.head.next=t.next,t.next.prev=this.head,t.prev=t.next=null,this.size--,t.data},t.prototype.isEmpty=function(){return 0===this.size},t.prototype.forEach=function(t){for(var e=this.head.next;e!==this.tail;e=e.next)t(e.data)},t.prototype.remove=function(t){t.next.prev=t.prev,t.prev.next=t.next,this.size--},t.prototype.iterator=function(){var t=this.head,e=this;return function(){return t!==e.tail?(t=t.next).data:null}},t}();(z=G||(G={}))[z.UNDEFINED=0]="UNDEFINED",z[z.LEFT=1]="LEFT",z[z.RIGHT=2]="RIGHT",z[z.NON=3]="NON";var z;function $(t){return null===t.alias?"<"+t.sym+">":'"'+t.alias+'"'}var q,W=function(){function t(t,e){this.defred=null,this.g=t;var n=t.tokenCount,r=t.nts.length;this.stateCount=e,this.shift=new Array(n*e),this.gotot=new Array(r*e);for(var a=0;a<this.shift.length;a++)this.shift[a]=null;for(a=0;a<this.gotot.length;a++)this.gotot[a]=null}return t.prototype.forEachShift=function(t){for(var e=0;e<this.stateCount;e++)for(var n=0;n<this.g.tokens.length;n++){var r=this.lookupShift(e,n);r&&t(r,e,n)}},t.prototype.forEachGoto=function(t){for(var e=0;e<this.stateCount;e++)for(var n=0;n<this.g.nts.length;n++){var r=this.lookupGoto(e,n);r&&t(r,e,n)}},t.prototype.lookupShift=function(t,e){return this.shift[this.g.tokenCount*t+e]},t.prototype.lookupGoto=function(t,e){return this.gotot[this.g.nts.length*t+e]},t.prototype._getDefRed=function(t,e){for(var n=0;n<e.length;n++)e[n]=0;for(var r=0;r<this.g.tokenCount;r++){var a=this.lookupShift(t,r);a&&a.actionType===B.REDUCE&&e[a.rule.index]++}var s=0;for(n=0;n<e.length;n++)e[n]>e[s]&&(s=n);return e[s]>0?s:-1},t.prototype.findDefAct=function(){this.defred=new Array(this.stateCount);for(var t=new Array(this.g.rules.length),e=0;e<this.stateCount;e++){var n=this._getDefRed(e,t);if(this.defred[e]=n,-1!==n)for(var r=0;r<this.g.tokens.length;r++){var a=this.lookupShift(e,r);a&&a.actionType===B.REDUCE&&a.rule.index===n&&(this.shift[this.g.tokenCount*e+r]=null)}}},t}();(Y=q||(q={}))[Y.RR=0]="RR",Y[Y.SR=1]="SR";var Y,Q=function(){function t(){}return t.prototype.toString=function(){return"state "+this.set.stateIndex+", "+t.cNames[this.type]+" conflict:"+g+s+"token: "+$(this.token)+g+s+"used rule: "+this.used.toString()+g+s+"discarded rule: "+this.discarded.toString()},t.cNames=["reduce/reduce","shift/reduce"],t}();function X(t){var e={},n=0;function r(t){var n=t.kernelHash();void 0===e[n]&&(e[n]=[]),e[n].push(t)}function a(t,n){var r=e[t.kernelHash()];if(void 0!==r)for(var a=0;a<r.length&&!n(r[a]);a++);}var s=1,o=new j,u=new j,c=new j;for(o.append(function(t){var e=t.nts[0].rules[0],n=new K(t);n.index=0;var r=new P(t.tokenCount);return r.add(1),n.add(e,0,!0,r,!1),n}(t));!o.isEmpty()||!u.isEmpty();){var l=null;if(!u.isEmpty()){(h=l=u.pull()).forEach(function(e){if(e.actionType===B.NONE){i.assert(e.canShift());var n=e.getShift(),r=new K(t);r.index=s++,o.append(r),h.forEach(function(t){if(t.canShift()){t.getShift()===n&&(t.actionType=B.SHIFT,t.shift=r,r.add(t.rule,t.marker+1,!0,t.lah,!1))}})}}),h.complete=!0,c.append(h)}for(;!o.isEmpty();){var h;(h=o.pull()).closure(),h.forEach(function(t){t.canShift()||(t.actionType=B.REDUCE)});var f=null;a(h,function(t){return!!t.canMergeTo(h)&&(t.mergeTo(h)&&t.complete&&(f=t),null!==l&&l.forEach(function(e){e.actionType===B.SHIFT&&e.shift===h&&(e.shift=t)}),h=null,!0)}),null!==f?(c.remove(f),u.append(f),f.complete=!1):null!==h&&(u.append(h),r(h))}n++}var d=0;return c.forEach(function(t){t.stateIndex=d++}),{result:c,iterations:n}}function J(t){var e=[];return{add:function(n){var r;for(r=0;r<e.length&&!((0===r||t(n,e[r-1])>=0)&&t(n,e[r])<=0);r++);!function(t,n){e.push(null);for(var r=e.length-1;r>t;r--)e[r]=e[r-1];e[t]=n}(r,n)},done:function(){return e}}}var Z=function(){return function(t,e){this.emptyCount=t,this.row=e,this.dp=0}}();function tt(t){function e(e,n){return(n-=i[e].dp)<0||n>=t.columns||t.isEmpty(i[e].row,n)}function n(n,r){for(var a=0;a<t.columns;a++)if(!e(n,a))for(var s=0;s<n;s++)if(!e(s,a+r))return!1;return!0}function r(e){for(var r=0;-r<t.columns&&t.isEmpty(i[e].row,-r);)r--;for(;!n(e,r);)r++;return r}for(var a=J(function(t,e){return t.emptyCount<e.emptyCount?-1:t.emptyCount>e.emptyCount?1:0}),s=0;s<t.rows;s++)a.add(new Z(t.emptyCount(s),s));for(var i=a.done(),o=0,u=0,c=new Array(t.rows),l=0;-l<t.columns&&t.isEmpty(i[0].row,-l);)l--;c[i[0].row]=i[0].dp=l;for(s=1;s<i.length;s++){var h=i[s].row,f=r(s);c[h]=i[s].dp=f,f>o&&(o=f),f<u&&(u=f)}return{dps:c,len:o+t.columns}}function et(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e(r);return n}var nt=function(){function t(t){this.g=t.g,this.defred=t.defred,this.stateCount=t.stateCount;var e=tt(function(t){for(var e=[],n=0;n<t.stateCount;n++){e.push(0);for(var r=0;r<t.g.tokens.length;r++)null===t.lookupShift(n,r)&&e[n]++}return{rows:t.stateCount,columns:t.g.tokens.length,isEmpty:function(e,n){return null===t.lookupShift(e,n)},emptyCount:function(t){return e[t]}}}(t)),n=tt(function(t){for(var e=[],n=0;n<t.stateCount;n++){e.push(0);for(var r=0;r<t.g.nts.length;r++)null===t.lookupShift(n,r)&&e[n]++}return{rows:t.stateCount,columns:t.g.nts.length,isEmpty:function(e,n){return null===t.lookupGoto(e,n)},emptyCount:function(t){return e[t]}}}(t));this.disact=e.dps,this.disgoto=n.dps,this.pact=et(e.len,function(){return null}),this.checkact=et(e.len,function(){return 0});var r=this;t.forEachShift(function(t,e,n){i.assert(null===r.pact[r.disact[e]+n]),r.pact[r.disact[e]+n]=t,r.checkact[r.disact[e]+n]=e}),this.pgoto=et(n.len,function(){return null}),this.checkgoto=et(n.len,function(){return 0}),t.forEachGoto(function(t,e,n){i.assert(null===r.pgoto[r.disgoto[e]+n]),r.pgoto[r.disgoto[e]+n]=t,r.checkgoto[r.disgoto[e]+n]=e})}return t.prototype.lookupShift=function(t,e){var n=this.disact[t]+e;return n>=0&&n<this.pact.length&&this.checkact[n]===t?this.pact[this.disact[t]+e]:null},t.prototype.lookupGoto=function(t,e){var n=this.disgoto[t]+e;return n>=0&&n<this.pgoto.length&&this.checkgoto[n]===t?this.pgoto[this.disgoto[t]+e]:null},t}(),rt=function(){function t(t,e,n){this.g=t,this.lhs=e,this.pos=n,this.pr=-1,this.rhs=[],this.action=null,this.index=0,this.vars={},this.usedVars={}}return t.prototype.calcPr=function(){if(-1===this.pr)for(var t=this.rhs.length-1;t>=0;t--){var e=this.rhs[t];e>=0&&this.g.tokens[e].assoc!==G.UNDEFINED&&(this.pr=this.g.tokens[e].pr)}},t.prototype.getVarSp=function(t,e){if(1!==this.lhs.parents.length)return this.lhs.parents.length>1?e("LHS of the rule is referenced by more than one rule"):e("this rule is unreachable"),null;for(var n=this.rhs.length,r=this.lhs.parents[0].pos,a=this.lhs.parents[0].rule;;){var s=a.vars[t];if(void 0!==s&&s.val<r)return n+=r-s.val;if(1!==a.lhs.parents.length)return a.lhs.parents.length>1?e('"'+a.lhs.sym+'" is referenced by more than one rule or unreachable'):e("variable is undefined"),null;n+=r,r=a.lhs.parents[0].pos,a=a.lhs.parents[0].rule}},t.prototype.toString=function(t){for(var e=this.index+": "+this.lhs.sym+" =>",n=0;n<this.rhs.length;n++){var r=this.rhs[n];t===n&&(e+=" ."),e+=r>=0?" "+$(this.g.tokens[r]):" "+this.g.nts[-r-1].sym}return t===this.rhs.length&&(e+=" ."),e},t}(),at=function(){function t(){this.tokens=[],this.tokenCount=0,this.nts=[],this.rules=[]}return t.prototype.isToken=function(t){return t>=0},t.prototype.forEachRule=function(t){for(var e=0;e<this.nts.length;e++)for(var n=this.nts[e].rules,r=0;r<n.length;r++)t(e,n[r])},t.prototype.forEachRuleOfNt=function(t,e){for(var n=this.nts[t].rules,r=0;r<n.length&&!e(n[r]);r++);},t.prototype.genFirstSets=function(){var t=!0,e=new P(this.tokens.length);for(e.addAll(),e.remove(0);t;){t=!1;for(var n=0;n<this.nts.length;n++)for(var r=this.nts[n].rules,a=this.nts[n].firstSet,s=0;s<r.length;s++){for(var i=r[s],o=0;o<i.rhs.length;o++){var u=i.rhs[o];if(this.isToken(u)){t=a.add(u+1)||t;break}if(n!==(u=-u-1)&&(t=a.union(this.nts[u].firstSet,e)||t),!this.nts[u].firstSet.contains(0))break}o===i.rhs.length&&(t=a.add(0)||t)}}},t.prototype.toString=function(t){void 0===t&&(t={});var e=(t=t||{}).endl||e,n=t.escape||!1,r="";if(this.forEachRule(function(t,n){var a=n.toString();r+=a+e}),t.firstSets)for(var a=0;a<this.nts.length;a++){var s=this.nts[a];r+="First("+s.sym+") = { "+s.firstSet.toString(this)+" }"+e}return n&&(r=r.replace(/</g,"&lt;").replace(/>/g,"&gt;")),r.replace(/\n/g,e)},t.prototype.findTokenByName=function(t){for(var e=0,n=this.tokens;e<n.length;e++){var r=n[e];if(r.sym===t)return r}return null},t.prototype.findTokensByAlias=function(t){for(var e=[],n=0,r=this.tokens;n<r.length;n++){var a=r[n];a.alias===t&&e.push(a)}return e},t}();function st(t){return{val:t,ext:null,startLine:-1,startColumn:0,endLine:0,endColumn:0}}function it(t,e,n){void 0===n&&(n="^");if(-1!==t.startLine){var r="(line "+(t.startLine+1)+", column "+(t.startColumn+1)+"):"+g,a=t.startLine,s=t.startColumn;for(r+=e[a]+g,r+=function(t,e){for(var n="";e-- >0;)n+=t;return n}(" ",s);a<=t.endLine&&s<=t.endColumn;)r+=n,s++>=e[a].length&&(s=0,r+=g+e[++a]+g);return r}return"(internal position)"}var ot=function(){return function(){this.grammar=null,this.lexDFA=[],this.opt={},this.prefix="jj",this.header=[],this.output=st("typescript"),this.extraArgs=null,this.initArg=null,this.initBody=null,this.epilogue=st(""),this.sematicType=null}}(),ut=function(){function t(t){this.getRes=t,this._blocked={}}return t.prototype.wait=function(t,e){var n=this.getRes(t);void 0===n?(this._blocked[t]||(this._blocked[t]=[]),this._blocked[t].push(e)):e(!0,n)},t.prototype.signal=function(t,e){var n=this._blocked[t];if(void 0!==n){for(var r=0,a=n;r<a.length;r++){(0,a[r])(!0,e)}delete this._blocked[t]}},t.prototype.fail=function(){for(var t in this._blocked)for(var e=0,n=this._blocked[t];e<n.length;e++){(0,n[e])(!1,null)}},t}(),ct=function(){return function(t){this.label=t,this.opcodes=[]}}();function lt(t){}function ht(t,e){return{toCode:function(n){n.addBlock(t,e)},token:-1}}var ft;(dt=ft||(ft={}))[dt.TOKEN=0]="TOKEN",dt[dt.STRING=1]="STRING",dt[dt.NAME=2]="NAME";var dt;function pt(t){var e,n=new ot,r=new at,a={},s={},i=[],o=null,u={},c=null,l=0,h=!0,f=1,d=[],p=[],v={};return n.grammar=r,e=function(t){var e,n=new T,r=null,a=[],s=[],i=null,o=!1,u=null,c=!1,l=0,h={},f=[new ct("")],d={DEFAULT:0},p=[],v=null,g=[];return{prepareVar:function(e,n){var r=h[e];void 0!==r&&t.err(new N('variable "'+e+'" was already defined at line '+r.line,n)),r=h[e]={line:n,cmds:new ct(e)},v=r.cmds},endVar:function(){v=null},prepareLex:function(){p.length=0},selectState:function(t){var n=d[t];void 0===n&&(n=d[t]=f.length,f.push(new ct("")),e.signal(t,n)),p.push(f[d[t]])},newState:function(){c=!0,u=null,k(function(){r=new T,n.epsilonTo(r)})},end:function(t,e){void 0===e&&(e="(untitled)");for(var n=0,a=p;n<a.length;n++){var s=a[n];s.label="<"+e+">"}k(function(){var e=new w;e.id=e.priority=l++,e.data=t,r.endAction=e})},enterUnion:function(){k(function(){a.push({head:r,tail:new T})})},endUnionItem:function(){k(function(){var t=a[a.length-1];r.epsilonTo(t.tail),r=t.head})},leaveUnion:function(){k(function(){r=a.pop().tail})},enterSimple:function(){k(function(){s.push(r)})},simplePostfix:function(t){""===t||(u=null,c=!1),k(function(){var e=s.pop();"?"===t?e.epsilonTo(r):"+"===t?r.epsilonTo(e):"*"===t&&(r.epsilonTo(e),r=e)})},addString:function(t){c?(u=t,c=!1):u=null,k(function(){for(var e=0;e<t.length;e++){var n=new T;r.to(n).chars.add(t.charCodeAt(e)),r=n}})},addVar:function(e,n){c=!1,u=null,k(function(){var r=h[e];void 0===r&&t.err(new N('use of undefined variable "'+e+'"',n));for(var a=r.cmds,s=0;s<g.length;s++){var i=g[s];if(i.cmds===a){var o="circular dependence in lexical variable detected: "+a.label;for(s++;s<g.length;s++)o+=" -> "+g[s].cmds.label;return o+=" -> "+a.label,void t.err(new N(o,n))}}g.push({pc:0,cmds:a})})},beginSet:function(t){c=!1,u=null,k(function(){o=t;var e=new T;i=r.to(e),r=e,t&&i.chars.addAll()})},addSetItem:function(e,n,r,a){1===e.length?1===n.length?(e.charCodeAt(0)>n.charCodeAt(0)&&t.err(new N("left hand side must be larger than right hand side in wild card character (got '"+e+"' > '"+n+"')",r)),k(function(){o?i.chars.remove(e.charCodeAt(0),n.charCodeAt(0)):i.chars.add(e.charCodeAt(0),n.charCodeAt(0))})):t.err(new N('character expected in union, got "'+n+'"',a)):t.err(new N('character expected in union, got "'+e+'"',r))},endSet:function(){k(function(){i=null})},build:function(){for(var t=[],n=0,r=f;n<r.length;n++){var a=r[n];t.push(m(a))}return e.fail(),t},getPossibleAlias:function(){return u},requiringState:e=new ut(function(t){return d[t]})};function k(t){if(null!==v)v.opcodes.push(t);else for(var e=0,n=p;e<n.length;e++)n[e].opcodes.push(t)}function m(t){for((n=r=new T).isStart=!0,a.length=0,s.length=0,i=null,o=!1,g.length=0,g.push({pc:0,cmds:t});g.length>0;){var e=g[g.length-1];e.cmds.opcodes[e.pc++](),(e=g[g.length-1]).pc>=e.cmds.opcodes.length&&g.pop()}n.removeEpsilons();var u=n.toDFA();return new R(u.states)}}(t),c=new ut(function(t){return u[t]}),b(st("EOF"),null),{err:function(e,n){t.err(new N(e,n))},defToken:b,getTokenByAlias:E,getTokenByName:_,defineTokenPrec:function(t,e,n){if(n===ft.TOKEN){var r=_(t);null!==r&&(r.assoc=e,r.pr=f)}else if(n===ft.STRING){var r=E(t);null!==r&&(r.assoc=e,r.pr=f)}else if(n===ft.NAME)v[t.val]=v[t.val]||{assoc:e,pr:f,pos:t}},setOpt:function(t,e){n.opt[t.val]={name:t,val:e}},setOutput:function(t){n.output=t},setHeader:function(t){n.header.push(t)},setExtraArg:function(t){n.extraArgs=t},setType:function(t){n.sematicType=t},setInit:function(t,e){n.initArg=t,n.initBody=e},setEpilogue:function(t){n.epilogue=t},incPr:function(){f++},prepareRule:A,addRuleUseVar:function(t){var e=g();void 0!==e.usedVars[t.val]?m('re-use of sematic variable "'+t.val+'"',t):e.usedVars[t.val]={pos:t,val:0}},addRuleSematicVar:function(t){var e=g();void 0!==e.usedVars[t.val]?m('variable "'+t.val+'" conflicts with another imported variable',t):void 0!==e.vars[t.val]?m('sematic variable "'+t.val+'" is already defined',t):o=t},addRuleItem:x,addAction:y,defineRulePr:function(t,e){if(e===ft.STRING||e===ft.TOKEN){var n=e===ft.STRING?E(t):_(t);if(null!==n){if(n.assoc===G.UNDEFINED)return void m('precedence of token "'+t.val+'" has not been defined',t);g().pr=n.pr}}else{var r=v[t.val];r||m('pseudo token "'+t+'" is not defined',t),g().pr=r.pr}},commitRule:S,addPushStateAction:function(t,n){e.requiringState.wait(n.val,function(e,r){e?t.push((a=r,{toCode:function(t){t.pushLexState(a)},token:-1})):m('state "'+n.val+'" is undefined',n);var a})},build:function(){r.tokenCount=r.tokens.length,r.tokens[0].used=!0,r.nts[0].used=!0;for(var t=0,a=r.nts;t<a.length;t++){var s=a[t];s.firstSet=new P(r.tokenCount);for(var i=0,o=s.rules;i<o.length;i++){var u=o[i];u.calcPr();var l=function(t){var e=u.usedVars[t];e.val=u.getVarSp(t,function(n){m('cannot find variable "'+t+'": '+n,e.pos)})};for(var h in u.usedVars)l(h)}}n.lexDFA=e.build();for(var f=0,d=p;f<d.length;f++){var v=d[f];v()}return c.fail(),n},lexBuilder:e};function g(){return i[i.length-1]}function k(){var t=o;o=null;var e=g(),n="@"+l++;A(st(n));var r=g();y(e.action),S(),e.action=null,x(st(n),ft.NAME),o=t;for(var a in e.vars){var s=e.vars[a];r.usedVars[a]={val:s.val,pos:s.pos}}for(var a in e.usedVars){s=e.usedVars[a];r.usedVars[a]={val:s.val,pos:s.pos}}}function m(e,n){t.requireLines(function(t,r){t.err(new L(e+" "+it(n,r),"CompilationError"))})}function b(t,e){var n=a[t.val];return void 0!==n?(n.appears.push(t),n):(n={index:r.tokens.length,sym:t.val,alias:e,pr:0,assoc:G.UNDEFINED,used:!1,appears:[t]},null!==e&&(s[e]||(s[e]=[]),s[e].push(n)),a[t.val]=n,r.tokens.push(n),n)}function E(t){var e=s[t.val];if(void 0===e)return m('cannot identify "'+t.val+'" as a token',t),null;if(e.length>1){for(var n="",r=0;r<e.length;r++)r>0&&(n+=","),n+="<"+e[r].sym+">";return m("cannot identify "+t.val+" as a token, since it could be "+n,t),null}return e[0]}function _(t){var e=a[t.val];return void 0===e?(m("cannot identify <"+t.val+"> as a token",t),null):e}function A(t){h&&(h=!1,A(st("(accept)")),x(st(t.val),ft.NAME),x(st("EOF"),ft.TOKEN),S());var e=u[t.val];void 0===e&&(e=u[t.val]={index:r.nts.length,sym:t.val,firstSet:null,used:!1,rules:[],parents:[]},r.nts.push(e),c.signal(t.val,e));var n=new rt(r,e,t);i.push(n)}function x(t,e){var n=g();if(null!==n.action&&k(),null!==o&&(n.vars[o.val]={val:n.rhs.length,pos:o},o=null),e===ft.NAME){var r=n.rhs.length;n.rhs.push(0),c.wait(t.val,function(e,a){e?(n.rhs[r]=-a.index-1,a.parents.push({rule:n,pos:r}),a.used=!0):m("use of undefined non terminal "+t.val,t)})}else if(e===ft.TOKEN){var s=a[t.val];if(void 0===s)return void m("cannot recognize <"+t.val+"> as a token",t);n.rhs.push(s.index),s.used=!0}else if(e===ft.STRING){var i=E(t);null!==i&&(n.rhs.push(i.index),i.used=!0)}}function y(t){var e=g();null!==e.action&&k(),e.action=t,null!==o&&(e.vars[o.val]={val:e.rhs.length,pos:o},o=null,k())}function S(){var t=i.pop();t.index=r.rules.length,t.lhs.rules.push(t),r.rules.push(t);for(var e=0,n=d;e<n.length;e++){(0,n[e])()}d.length=0}}function vt(t){return{val:t.val,ext:null,startLine:t.startLine,startColumn:t.startColumn,endLine:t.endLine,endColumn:t.endColumn}}function gt(t){return{val:null,ext:null,startLine:t.startLine,startColumn:t.startColumn,endLine:t.endLine,endColumn:t.endColumn}}function kt(t){return t.replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\r/g,"\r").replace(/\\\\/g,"\\")}var mt=[function(t,e){switch(e.state){case 0:e.hasArc=!0,e.isEnd=!1,e.state=t>=9&&t<=10||13===t||32===t?1:34===t?2:36===t||t>=65&&t<=90||95===t||t>=97&&t<=122?3:37===t?4:39===t?5:40===t?6:41===t?7:42===t?8:43===t?9:44===t?10:45===t?11:47===t?12:58===t?13:59===t?14:60===t?15:61===t?16:62===t?17:63===t?18:91===t?19:93===t?20:94===t?21:123===t?22:124===t?23:125===t?24:-1;break;case 1:e.hasArc=!0,e.isEnd=!0,e.state=t>=9&&t<=10||13===t||32===t?1:-1;break;case 2:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=33||t>=35&&t<=91||t>=93?25:34===t?26:92===t?27:-1;break;case 3:e.hasArc=!0,e.isEnd=!0,e.state=36===t||t>=65&&t<=90||95===t||t>=97&&t<=122?28:t>=48&&t<=57?29:-1;break;case 4:e.hasArc=!0,e.isEnd=!1,e.state=37===t?30:101===t?31:104===t?32:105===t?33:108===t?34:110===t?35:111===t?36:112===t?37:114===t?38:116===t?39:117===t?40:-1;break;case 5:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=38||t>=40&&t<=91||t>=93?41:39===t?42:92===t?43:-1;break;case 6:case 7:case 8:case 9:case 10:case 11:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 12:e.hasArc=!0,e.isEnd=!1,e.state=42===t?44:47===t?45:-1;break;case 13:case 14:case 15:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 16:e.hasArc=!0,e.isEnd=!0,e.state=62===t?46:-1;break;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 25:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=33||t>=35&&t<=91||t>=93?25:34===t?26:92===t?27:-1;break;case 26:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 27:e.hasArc=!0,e.isEnd=!1,e.state=34===t||39===t||92===t||98===t||102===t||110===t||114===t||116===t?47:117===t||120===t?48:-1;break;case 28:case 29:e.hasArc=!0,e.isEnd=!0,e.state=36===t||t>=65&&t<=90||95===t||t>=97&&t<=122?28:t>=48&&t<=57?29:-1;break;case 30:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 31:e.hasArc=!0,e.isEnd=!1,e.state=109===t?49:120===t?50:-1;break;case 32:e.hasArc=!0,e.isEnd=!1,e.state=101===t?51:-1;break;case 33:e.hasArc=!0,e.isEnd=!1,e.state=110===t?52:-1;break;case 34:e.hasArc=!0,e.isEnd=!1,e.state=101===t?53:-1;break;case 35:e.hasArc=!0,e.isEnd=!1,e.state=111===t?54:-1;break;case 36:e.hasArc=!0,e.isEnd=!1,e.state=112===t?55:117===t?56:-1;break;case 37:e.hasArc=!0,e.isEnd=!1,e.state=114===t?57:-1;break;case 38:e.hasArc=!0,e.isEnd=!1,e.state=105===t?58:-1;break;case 39:e.hasArc=!0,e.isEnd=!1,e.state=121===t?59:-1;break;case 40:e.hasArc=!0,e.isEnd=!1,e.state=115===t?60:-1;break;case 41:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=38||t>=40&&t<=91||t>=93?41:39===t?42:92===t?43:-1;break;case 42:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 43:e.hasArc=!0,e.isEnd=!1,e.state=34===t||39===t||92===t||98===t||102===t||110===t||114===t||116===t?61:117===t||120===t?62:-1;break;case 44:e.hasArc=!0,e.isEnd=!1,e.state=t<=41||t>=43&&t<=46||t>=48?63:42===t?64:47===t?65:-1;break;case 45:e.hasArc=!0,e.isEnd=!0,e.state=t<=9||t>=11?66:-1;break;case 46:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 47:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=33||t>=35&&t<=91||t>=93?25:34===t?26:92===t?27:-1;break;case 48:e.hasArc=!0,e.isEnd=!1,e.state=t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?67:-1;break;case 49:e.hasArc=!0,e.isEnd=!1,e.state=112===t?68:-1;break;case 50:e.hasArc=!0,e.isEnd=!1,e.state=116===t?69:-1;break;case 51:e.hasArc=!0,e.isEnd=!1,e.state=97===t?70:-1;break;case 52:e.hasArc=!0,e.isEnd=!1,e.state=105===t?71:-1;break;case 53:e.hasArc=!0,e.isEnd=!1,e.state=102===t?72:120===t?73:-1;break;case 54:e.hasArc=!0,e.isEnd=!1,e.state=110===t?74:-1;break;case 55:e.hasArc=!0,e.isEnd=!1,e.state=116===t?75:-1;break;case 56:e.hasArc=!0,e.isEnd=!1,e.state=116===t?76:-1;break;case 57:e.hasArc=!0,e.isEnd=!1,e.state=101===t?77:-1;break;case 58:e.hasArc=!0,e.isEnd=!1,e.state=103===t?78:-1;break;case 59:e.hasArc=!0,e.isEnd=!1,e.state=112===t?79:-1;break;case 60:e.hasArc=!0,e.isEnd=!1,e.state=101===t?80:-1;break;case 61:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=38||t>=40&&t<=91||t>=93?41:39===t?42:92===t?43:-1;break;case 62:e.hasArc=!0,e.isEnd=!1,e.state=t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?81:-1;break;case 63:e.hasArc=!0,e.isEnd=!1,e.state=t<=41||t>=43&&t<=46||t>=48?63:42===t?64:47===t?82:-1;break;case 64:e.hasArc=!0,e.isEnd=!1,e.state=t<=46||t>=48?83:47===t?84:-1;break;case 65:e.hasArc=!0,e.isEnd=!1,e.state=47===t?85:-1;break;case 66:e.hasArc=!0,e.isEnd=!0,e.state=t<=9||t>=11?66:-1;break;case 67:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=33||t>=35&&t<=47||t>=58&&t<=64||t>=71&&t<=91||t>=93&&t<=96||t>=103?25:34===t?26:t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?86:92===t?27:-1;break;case 68:e.hasArc=!0,e.isEnd=!1,e.state=116===t?87:-1;break;case 69:e.hasArc=!0,e.isEnd=!1,e.state=114===t?88:-1;break;case 70:e.hasArc=!0,e.isEnd=!1,e.state=100===t?89:-1;break;case 71:e.hasArc=!0,e.isEnd=!1,e.state=116===t?90:-1;break;case 72:e.hasArc=!0,e.isEnd=!1,e.state=116===t?91:-1;break;case 73:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 74:e.hasArc=!0,e.isEnd=!1,e.state=97===t?92:-1;break;case 75:e.hasArc=!0,e.isEnd=!1,e.state=105===t?93:-1;break;case 76:e.hasArc=!0,e.isEnd=!1,e.state=112===t?94:-1;break;case 77:e.hasArc=!0,e.isEnd=!1,e.state=99===t?95:-1;break;case 78:e.hasArc=!0,e.isEnd=!1,e.state=104===t?96:-1;break;case 79:e.hasArc=!0,e.isEnd=!1,e.state=101===t?97:-1;break;case 80:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 81:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=38||t>=40&&t<=47||t>=58&&t<=64||t>=71&&t<=91||t>=93&&t<=96||t>=103?41:39===t?42:t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?98:92===t?43:-1;break;case 82:e.hasArc=!0,e.isEnd=!1,e.state=t<=41||t>=43&&t<=46||t>=48?63:42===t?64:47===t?82:-1;break;case 83:e.hasArc=!0,e.isEnd=!1,e.state=t<=41||t>=43&&t<=46||t>=48?63:42===t?64:47===t?65:-1;break;case 84:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 85:e.hasArc=!0,e.isEnd=!1,e.state=t<=41||t>=43&&t<=46||t>=48?63:42===t?64:47===t?65:-1;break;case 86:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=33||t>=35&&t<=47||t>=58&&t<=64||t>=71&&t<=91||t>=93&&t<=96||t>=103?25:34===t?26:t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?86:92===t?27:-1;break;case 87:e.hasArc=!0,e.isEnd=!1,e.state=121===t?99:-1;break;case 88:e.hasArc=!0,e.isEnd=!1,e.state=97===t?100:-1;break;case 89:e.hasArc=!0,e.isEnd=!1,e.state=101===t?101:-1;break;case 90:case 91:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 92:e.hasArc=!0,e.isEnd=!1,e.state=115===t?102:-1;break;case 93:e.hasArc=!0,e.isEnd=!1,e.state=111===t?103:-1;break;case 94:e.hasArc=!0,e.isEnd=!1,e.state=117===t?104:-1;break;case 95:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 96:e.hasArc=!0,e.isEnd=!1,e.state=116===t?105:-1;break;case 97:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 98:e.hasArc=!0,e.isEnd=!1,e.state=t<=9||t>=11&&t<=38||t>=40&&t<=47||t>=58&&t<=64||t>=71&&t<=91||t>=93&&t<=96||t>=103?41:39===t?42:t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102?98:92===t?43:-1;break;case 99:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 100:e.hasArc=!0,e.isEnd=!1,e.state=95===t?106:-1;break;case 101:e.hasArc=!0,e.isEnd=!1,e.state=114===t?107:-1;break;case 102:e.hasArc=!0,e.isEnd=!1,e.state=115===t?108:-1;break;case 103:e.hasArc=!0,e.isEnd=!1,e.state=110===t?109:-1;break;case 104:e.hasArc=!0,e.isEnd=!1,e.state=116===t?110:-1;break;case 105:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 106:e.hasArc=!0,e.isEnd=!1,e.state=97===t?111:-1;break;case 107:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 108:e.hasArc=!0,e.isEnd=!1,e.state=111===t?112:-1;break;case 109:case 110:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;case 111:e.hasArc=!0,e.isEnd=!1,e.state=114===t?113:-1;break;case 112:e.hasArc=!0,e.isEnd=!1,e.state=99===t?114:-1;break;case 113:e.hasArc=!0,e.isEnd=!1,e.state=103===t?115:-1;break;case 114:case 115:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;default:e.state=-1,e.hasArc=!1}},function(t,e){switch(e.state){case 0:e.hasArc=!0,e.isEnd=!0,e.state=t<=122||124===t||t>=126?1:123===t?2:125===t?3:-1;break;case 1:e.hasArc=!0,e.isEnd=!0,e.state=t<=122||124===t||t>=126?1:-1;break;case 2:case 3:e.hasArc=!1,e.isEnd=!0,e.state=-1;break;default:e.state=-1,e.hasArc=!1}},function(t,e){switch(e.state){case 0:e.hasArc=!0,e.isEnd=!1,e.state=1;break;case 1:e.hasArc=!0,e.isEnd=!0,e.state=1;break;default:e.state=-1,e.hasArc=!1}}],bt=[-1,-1,-1,1,-1,-1,20,21,26,27,35,28,-1,29,31,19,22,18,25,23,24,34,3,33,4,-1,2,-1,1,1,32,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,-1,-1,-1,30,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,-1,-1,-1,-1,-1,-1,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,16,7,-1,-1,-1,15,-1,14,-1,13,-1,-1,-1,-1,-1,8,-1,11,-1,5,17,-1,-1,-1,9,12],Et=[36,36,3,4],_t=[-1,37],At=38,xt=171,yt=[9,7,15,16,17,151,10,11,170,12,85,13,14,-50,-111,118,-50,159,160,158,115,116,150,148,-87,118,149,5,-50,-51,115,116,-51,97,-105,94,97,26,97,-105,-87,155,-87,101,-51,26,97,60,-112,56,96,68,129,96,66,96,62,102,63,-39,169,49,141,96,48,167,57,43,44,166,165,141,163,128,153,152,145,112,133,132,60,131,130,126,-105,122,121,120,112,109,-94,107,106,105,104,103,98,91,89,88,83,79,77,76,72,71,70,65,58,51,47,45,41,37,21,32,27,21,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],St=[-38,118,-5,-38,116,-38,-38,44,113,-38,-38,-38,-38,113,-38,-38,-38,113,-38,-38,-38,94,36,-38,-38,-38,-38,-38,-38,-38,-38,-38,80,-38,38,108,109,-38,60,-38,72,-38,-38,-38,-38,31,-38,-38,86,-38,-38,25,-38,97,50,-38,105,103,-38,-38,101,-38,-38,90,82,-38,-38,-38,82,-38,-38,-38,-38,85,9,-38,98,76,96,44,-38,36,34,-38,74,31,22,-38,76,76,64,88,-38,-38,-38,90,-38,89,-38,-38,-38,88,-38,59,-38,-38,69,85,-38,67,-38,81,65,-38,81,-38,-38,79,76,-38,-38,-38,-38,55,-38,48,-38,-38,3,-38,-38,-38,-7,-38,43,11,-38,3,40,-38,46,-38,11,17,-38,-38,-8,-38,39,71,-38,69,68,65,-38,-5,-38,-38,-38,-38,44,60,42,-38,-38,-38,-38,-16,-38,-38],wt=[2,2,2,2,2,137,2,2,167,2,74,2,2,155,142,132,155,146,146,146,132,132,137,137,74,128,137,2,155,135,128,128,135,85,85,82,82,22,22,81,74,143,74,86,135,7,7,142,79,45,85,54,143,82,54,22,51,86,51,81,162,38,161,7,38,160,45,34,34,153,152,151,149,148,140,138,134,125,123,118,79,117,114,112,111,109,107,106,103,101,97,95,91,90,89,88,84,78,77,76,73,68,64,63,60,57,56,53,48,40,36,35,32,21,17,13,8,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Tt=[4,-1,-1,0,-1,3,5,-1,-1,104,104,104,104,-1,16,17,18,1,72,73,74,26,7,20,21,22,24,9,10,11,104,13,-1,71,-1,-1,-1,19,-1,12,14,80,76,77,30,-1,27,8,-1,2,15,-1,79,83,35,25,-1,-1,107,109,-1,75,80,89,-1,6,29,31,-1,28,23,108,78,99,91,87,-1,-1,47,110,81,100,-1,88,92,38,-1,85,-1,-1,-1,-1,101,102,103,-1,98,90,95,96,82,-1,47,37,47,112,-1,-1,84,-1,33,38,-1,42,-1,44,45,-1,-1,97,94,32,36,-1,40,37,53,63,104,43,46,108,104,34,48,53,52,-1,65,68,69,41,105,-1,53,51,58,47,64,-1,62,-1,-1,-1,39,53,54,55,56,57,-1,66,-1,67,70,106,59,-1,61,60],Ct=[5,92,123,7,146,85,83,35,22,23,145,137,156,145,137,143,113,94,63,141,41,99,123,80,81,37,21,167,138,139,163,161,122,123,133,124,118,153,110,58,60,58,60,91,89,126,107,116,118,24,116,118,98,73,74,124,118,66,86,68,77,72,53,54,49,24,124,118,45,34,32,30,118,17,18,19,1,142,2,160,126,155,136,137,134,135,136,137,112,126,109,126,79,51,52,53,39,118,38,29,118,28,118,33,19,27,118,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Rt=[75,-59,-4,-59,39,-59,21,0,-59,53,49,47,19,-59,-59,-59,-59,68,-59,-59,32,-4,16,-59,-59,-59,88,-59,-59,-59,44,-59,-59,-59,-18,-59,56,-59,-59,-59,58,54,-59,-59,50,-59,-59,-59,-59,-59,-59,-59,-59,-24,43,-59,-59,-59,-59,-59,-59,-59,21,9,-59,-59,-59,45,-59,-59,-59,37,-59,-27,-41,-59,15,-59,22,-15,-59,-17,-32,-59,-59,3,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,-2,-59,-59,-59,-59,68,21,66,-59,-59,-59,-59,-59,-59,14,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,-59,17,60,-59,-2,-59,-59,22,-5,-59,-59,-13,-59,-25,-59,-59,-59,-59,-17,-59,56,-59,-16,57,1,-59,-59,-3,-59,-59,-59,-16,-59,-59,-59,-59,-59,-4,-59,-59,-59,-59,-59,-59,-59,-59],Lt=[2,0,6,2,0,0,6,2,4,2,2,2,3,2,0,1,1,1,1,2,1,1,1,4,0,3,0,1,3,2,0,0,6,5,7,0,2,0,0,4,1,3,1,2,1,1,2,0,2,3,1,2,1,0,3,1,1,1,0,3,4,3,1,1,0,1,0,3,1,1,3,2,1,1,0,5,1,1,3,1,0,4,4,0,3,1,1,1,2,0,2,0,1,0,4,2,2,3,1,0,1,2,2,2,0,0,5,2,0,1,0,0,5],Nt=[0,2,1,3,3,5,4,4,4,4,4,4,4,4,6,6,7,7,7,8,8,9,9,10,10,11,11,12,12,13,13,15,14,14,14,16,17,17,19,18,18,20,20,21,21,21,21,23,22,24,24,25,25,27,26,28,28,28,28,29,29,29,29,30,30,31,31,32,32,33,33,34,34,35,37,36,38,38,39,39,41,40,42,42,43,43,44,44,45,45,46,46,47,48,47,47,47,49,49,50,50,50,51,51,53,54,52,55,55,56,57,58,56],It=["EOF","NAME","STRING","OPEN_BLOCK","CLOSE_BLOCK","OPT_DIR","LEX_DIR","LEFT_DIR","RIGHT_DIR","NONASSOC_DIR","USE_DIR","HEADER_DIR","EXTRA_ARG_DIR","EMPTY","TYPE_DIR","PREC_DIR","INIT_DIR","OUTPUT_DIR","GT","LT","BRA","KET","EQU","CBRA","CKET","QUESTION","STAR","PLUS","DASH","COLON","ARROW","EOL","SEPERATOR","OR","WEDGE","COMMA","ANY_CODE","ANY_EPLOGUE_CODE"],Dt=[null,null,null,"{","}","%option","%lex","%left","%right","%nonassoc","%use","%header","%extra_arg","%empty","%type","%prec","%init","%output",">","<","(",")","=","[","]","?","*","+","-",":","=>",";","%%","|","^",",",null,null];var Ot=function(){function t(t,e,n,r,a,s){this.id=t,this.val=e,this.startLine=n,this.startColumn=r,this.endLine=a,this.endColumn=s}return t.prototype.clone=function(){return new t(this.id,this.val,this.startLine,this.startColumn,this.endLine,this.endColumn)},t.prototype.toString=function(){return(null===Dt[this.id]?"<"+It[this.id]+">":'"'+Dt[this.id]+'"')+'("'+this.val+'")'},t}();function Ut(){var t,e,n,r,a,s,i,o,u,c,l,h,f,d,p,v={state:-1,line:0,column:0},g=[],k=[],m={};function b(t){n=t,o=s,u=i}function E(t){r.id=t,r.val=n,r.startLine=o,r.startColumn=u,r.endLine=s,r.endColumn=i-1,n="",o=s,u=i}function _(){for(A("token",It[r.id],r.val);!l&&!L(r););r.id=-1}function A(t,e,n,r){var a=m[t];if(a)for(var s=0;s<a.length;s++)a[s](e,n,r)}function x(t,e){switch(t){case 0:!function(t){var e=bt[t];switch(-1!==e&&E(e),t){case 1:b("");break;case 3:c=vt(r);break;case 22:case 24:c=gt(r);break;case 26:(c=vt(r)).val=kt(c.val.substr(1,c.val.length-2));break;case 28:case 29:c=vt(r);break;case 42:(c=vt(r)).val=kt(c.val.substr(1,c.val.length-2));break;case 45:case 66:case 84:b("")}}(e);break;case 1:!function(t){var e=Et[t];switch(-1!==e&&E(e),t){case 0:case 1:c=st(r.val);break;case 2:case 3:c=gt(r)}}(e);break;case 2:!function(t){var e=_t[t];switch(-1!==e&&E(e),t){case 1:c=vt(r)}}(e)}-1!==r.id&&_()}function y(){var t=n.substr(n.length-a,a);return n=n.substr(0,n.length-a),a=0,s=v.line,i=v.column,e=v.state,v.state=-1,t}function S(t){return"\n"===t?(s++,i=0):i++,n+=t,-1!==v.state&&a++,!0}function w(n){var r=t[t.length-1],o={state:e,hasArc:!1,isEnd:!1};if(mt[r](n.charCodeAt(0),o),o.isEnd)return o.hasArc?-1===o.state?(x(r,e),v.state=-1,a=0,e=0,!1):(v.state=e,v.line=s,v.column=i,a=0,e=o.state,S(n)):(x(r,e),v.state=-1,a=0,e=0,!1);if(-1===o.state){if(-1!==v.state){var u=y();return x(r,e),e=0,C(u),!1}return A("lexicalerror",'unexpected character "'+n+'"',s,i),!0}return e=o.state,S(n)}function T(){if(0===e)return E(0),_(),!0;var n=t[t.length-1],r={state:e,hasArc:!1,isEnd:!1};if(mt[n](-1,r),r.isEnd)return x(n,e),e=0,v.state=-1,!1;if(-1!==v.state){var a=y();return x(n,e),e=0,C(a),!1}return A("lexicalerror","unexpected end of file"),!0}function C(t){for(var e=0;e<t.length&&!l;)w(t.charAt(e))&&e++}function R(e){var n=Nt[e],r=k.length,a=k[r-Lt[e]]||null;switch(e){case 1:t.push(2);break;case 5:h.lexBuilder.prepareLex();break;case 9:var s=k[r-1];h.setHeader(s);break;case 10:s=k[r-1];h.setExtraArg(s);break;case 11:var i=k[r-1];h.setType(i);break;case 12:var o=k[r-2];s=k[r-1];h.setInit(o,s);break;case 13:var u=k[r-1];h.setOutput(u);break;case 15:var c=k[r-1];h.setEpilogue(c);break;case 16:f=G.LEFT;break;case 17:f=G.RIGHT;break;case 18:f=G.NON;break;case 21:i=k[r-1];h.defineTokenPrec(i,f,i.ext);break;case 22:i=k[r-1];h.defineTokenPrec(i,f,ft.NAME);break;case 23:var l=k[r-3],v=k[r-1];h.setOpt(l,v);break;case 26:h.lexBuilder.selectState("DEFAULT");break;case 27:case 28:y=k[r-1];h.lexBuilder.selectState(y.val);break;case 31:var m=k[r-1];h.lexBuilder.prepareVar(m.val,m.startLine);break;case 32:m=k[r-6];h.lexBuilder.endVar();break;case 33:h.lexBuilder.end(d,"(untitled)");break;case 34:var b=k[r-5],E=h.defToken(b,h.lexBuilder.getPossibleAlias());d.push({toCode:lt,token:E.index}),h.lexBuilder.end(d,b.val);break;case 35:h.lexBuilder.newState();break;case 37:case 38:d=[];break;case 40:s=k[r-1];d=[ht(s.val,s.startLine)];break;case 43:var _=k[r-1];h.addPushStateAction(d,_);break;case 44:d.push({toCode:function(t){t.popLexState()},token:-1});break;case 45:s=k[r-1];d.push(ht(s.val,s.startLine));break;case 46:y=k[r-1];d.push((N=y.val,{toCode:function(t){t.setImg(N)},token:-1}));break;case 47:h.lexBuilder.enterUnion();break;case 48:h.lexBuilder.leaveUnion();break;case 49:case 50:h.lexBuilder.endUnionItem();break;case 53:h.lexBuilder.enterSimple();break;case 54:var A=k[r-1];h.lexBuilder.simplePostfix(A.val);break;case 55:a=st("+");break;case 56:a=st("?");break;case 57:a=st("*");break;case 58:a=st("");break;case 61:var x=k[r-2];h.lexBuilder.addVar(x.val,x.startLine);break;case 62:y=k[r-1];h.lexBuilder.addString(y.val);break;case 63:h.lexBuilder.beginSet(!0);break;case 64:h.lexBuilder.beginSet(!1);break;case 69:var y=k[r-1];h.lexBuilder.addSetItem(y.val,y.val,y.startLine,y.startLine);break;case 70:var S=k[r-3],w=k[r-1];h.lexBuilder.addSetItem(S.val,w.val,S.startLine,w.startLine);break;case 74:x=k[r-1];p=x;break;case 80:h.prepareRule(p);break;case 81:h.commitRule();break;case 84:case 85:_=k[r-1];h.addRuleUseVar(_);break;case 90:var T=k[r-2];h.addRuleSematicVar(T);break;case 92:i=k[r-1];h.addRuleItem(i,ft.NAME);break;case 93:_=k[r-2];h.addRuleSematicVar(_);break;case 94:_=k[r-4],i=k[r-1];h.addRuleItem(i,ft.NAME);break;case 95:i=k[r-1];h.addRuleItem(i,i.ext);break;case 96:h.addAction(d);break;case 97:(a=i=k[r-2]).ext=ft.TOKEN;break;case 98:a.ext=ft.STRING;break;case 101:h.addAction(d);break;case 102:i=k[r-1];h.defineRulePr(i,ft.NAME);break;case 103:i=k[r-1];h.defineRulePr(i,i.ext);break;case 104:t.push(1);break;case 105:var C=k[r-2],R=k[r-1];t.pop();break;case 106:C=k[r-4],R=k[r-3];var L=k[r-1];(a=st("")).val=R.val,a.startLine=C.startLine,a.startColumn=C.startColumn,a.endLine=L.endLine,a.endColumn=L.endColumn;break;case 107:s=k[r-1];a.val+=s.val;break;case 108:a=st("");break;case 110:t.push(1);break;case 111:s=k[r-1];t.pop();break;case 112:s=k[r-3];(a=st("")).val="{"+s.val+"}"}var N;g.length-=Lt[e];var I=g[g.length-1];g.push(Ct[Rt[I]+n]),k.length-=Lt[e],k.push(a)}function L(t){var e=g[g.length-1],n=St[e]+t.id,r=0;return(r=n<0||n>=yt.length||wt[n]!==e?-Tt[e]-1:yt[n])===xt?(N(t),!0):r>0?0===t.id?(l=!0,A("accept"),!0):(g.push(r-1),k.push(c),c=null,!0):r<0?(R(-r-1),!1):(N(t),!0)}function N(t){var e="unexpected token "+t.toString()+", expecting one of the following token(s):\n";A("syntaxerror",e+=function(t){var e=St[t],n="";function r(n){var r=e+n;return!(r<0||r>=yt.length||t!==wt[r])||-1!==Tt[t]}for(var a=0;a<At;a++)r(a)&&(n+="    "+(s=a,null===Dt[s]?"<"+It[s]+">":'"'+Dt[s]+'"')+" ...\n");var s;return n}(g[g.length-1]),t)}return{init:function(f,d){t=[0],e=0,n="",r=new Ot(-1,null,0,0,0,0),v.state=-1,a=0,s=o=0,i=u=0,g=[0],k=[],c=null,l=!1,h=d},on:function(t,e){m[t]||(m[t]=[]),m[t].push(e)},accept:C,end:function(){for(;!l&&!T(););l=!0},halt:function(){l=!0}}}var Ft={};Bt=function(t,e){!function(t,e){h("/*"),h("    generated by jscc, an LALR(1) parser generator made by hadroncfy."),h("    template for typescript, written by hadroncfy, aussi."),l("*/");for(var n=0,r=t.file.header;n<r.length;n++){var a=r[n];h(""),l(a.val)}var s=t.file.prefix,i=c("tab","    ");function o(t,e){return void 0===e&&(e=""),null===t?e:t.val}function c(e,n){var r=t.file.opt[e];return void 0===r?n:r.val.val}function l(t){e.write(t)}function h(t){e.writeln(t)}function f(t,e){return(t.length<e?function(t,e){for(var n="";e-- >0;)n+=t;return n}(" ",e-t.length):"")+t}function d(e,n,r,a,o){var u=1;h(""),l("var "),l(s+e),h(" = [ "),l(i);for(var c=0,d=n;c<d.length;c++)l(f(o(d[c]),r)),l(","),u++>=a&&(u=1,l(t.endl+i));h(""),l("]; ")}function p(t){function e(t){var e=[];return t.chars.forEach(function(t,n){t===n?e.push("c === "+t):0===t&&n!==u.oo?e.push("c <= "+n):0!==t&&n===u.oo?e.push("c >= "+t):0!==t&&n!==u.oo?e.push("(c >= "+t+" && c <= "+n+")"):e.push("true")}),e.join(" || ")}var n=!0;if(h(""),l("        case "),l(t.index),h(":"),l("            ret.hasArc = "),l(t.arcs.length>0?"true":"false"),h(";"),l("            ret.isEnd = "),l(null===t.endAction?"false":"true"),l(";"),0===t.arcs.length)h(""),l("            ret.state = -1;");else if(t.hasDefinate())h(""),l("            ret.state = "),l(t.arcs[0].to.index),l(";");else{for(var r=0,a=t.arcs;r<a.length;r++){var s=a[r];h(""),l("            "),l(n?(n=!1,""):"else "),l("if("),l(e(s)),h("){"),l("                ret.state = "),l(s.to.index),h(";"),l("            }")}h(""),h("            else {"),h("                ret.state = -1;"),l("            } ")}h(""),l("            break;")}function v(t,e){h(""),l("function moveDFA"),l(e),h("(c: number, ret: { state: number, hasArc: boolean, isEnd: boolean }){"),l("    switch(ret.state){");for(var n=0,r=t.states;n<r.length;n++)p(r[n]);h(""),h("        default:"),h("            ret.state = -1;"),h("            ret.hasArc = false;"),h("    }"),l("}")}function g(t,e){d("lexTokens"+e,t.states,6,10,function(t){return t.endAction?function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(-1!==r.token)return r.token}return-1}(t.endAction.data).toString():"-1"})}var k=t.file.lexDFA;h(""),h("/*"),h("    find the next state to go in the dfa"),l("*/");for(var m=0,b=k;m<b.length;m++)v(b[m],m);h(""),h(""),h("/*"),h("    all the lexer data goes here."),h("*/"),l("var "),l(s),l("lexers = [");for(m=0;m<k.length;m++)h(""),l("    moveDFA"),l(m),l(",");h(""),h("];"),h(""),h("/*"),h("    tokens that a lexical dfa state can return"),l("*/");for(m=0,b=k;m<b.length;m++)g(b[m],m);h("");var E=t.pt;h(""),l("var "),l(s),l("stateCount = "),l(E.stateCount),h(";"),l("var "),l(s),l("tokenCount = "),l(t.file.grammar.tokens.length),h(";"),l("var "),l(s),l("actERR = "),l(E.stateCount+1),h(";"),h("/*"),l("    compressed action table: action = "),l(s),l("pact["),l(s),h("disact[STATE-NUM] + TOKEN]"),h("    when action > 0, shift the token and goto state (action - 1);"),h("    when action < 0, reduce with rule (1-action);"),h("    when action = 0, do default action."),l("*/"),d("pact",E.pact,6,10,function(t){return null===t?"0":t===H.NULL?String(E.stateCount+1):t.actionType===B.SHIFT?(t.shift.stateIndex+1).toString():t.actionType===B.REDUCE?(-t.rule.index-1).toString():void 0}),h(""),h("/*"),h("    displacement of action table."),l("*/"),d("disact",E.disact,6,10,function(t){return t.toString()}),h(""),h("/*"),l("    used to check if a position in "),l(s),h("pact is out of bouds."),l("    if "),l(s),l("checkact["),l(s),h("disact[STATE-NUM] + TOKEN] = STATE-NUM, this position is not out of bounds."),l("*/"),d("checkact",E.checkact,6,10,function(t){return void 0===t?"0":t.toString()}),h(""),h("/*"),l("    default action table. action = "),l(s),h("defred[STATE-NUM],"),h("    where action is the number of the rule to reduce with."),l("*/"),d("defred",E.defred,6,10,function(t){return t.toString()}),h(""),h("/*"),l("    compressed goto table: goto = "),l(s),l("pgoto["),l(s),h("disgoto[STATE-NUM] + NON_TERMINAL]"),l("*/"),d("pgoto",E.pgoto,6,10,function(t){return null===t?"-1":t.shift.stateIndex.toString()}),h(""),h("/*"),h("    displacement of the goto table"),l("*/"),d("disgoto",E.disgoto,6,10,function(t){return t.toString()}),h(""),h("/*"),l("    length of each rule: rule length = "),l(s),h("ruleLen[RULE-NUM]"),l("*/"),d("ruleLen",E.g.rules,6,10,function(t){return t.rhs.length.toString()}),h(""),h("/*"),h("    index of the LHS of each rule"),l("*/"),d("lhs",E.g.rules,6,10,function(t){return t.lhs.index.toString()}),h(""),h("/*"),h("    token names"),l("*/"),d("tokenNames",E.g.tokens,20,3,function(t){return'"'+t.sym+'"'}),h(""),h("/*"),h("    token alias"),l("*/"),d("tokenAlias",E.g.tokens,20,3,function(t){return t.alias?'"'+t.alias+'"':"null"});var _=c("className","Parser");h("");function A(t,e){var n={addBlock:function(t,e){h(""),l("                "),l(t.replace(/\$token/g,"_token").replace(/\$\$/g,"_sematicVal"))},pushLexState:function(t){h(""),l("                _lexState.push("),l(t),l(");")},popLexState:function(){h(""),l("                _lexState.pop();")},setImg:function(t){h(""),l('                _setImg("'),l(t),l('");')},returnToken:function(t){h(""),h("                this._token = {"),l("                    id: "),l(t.index),h(","),h("                    val: this._matched.join('')"),l("                };")}};function r(t){for(var e=0,n=t;e<n.length;e++)if(-1===n[e].token)return!0;return!1}var a=s+"staten";h(""),l("    function _doLexAction"),l(e),l("("),l(a),h(": number){"),l("        let "),l(s),l("tk = "),l(s),l("lexTokens"),l(e),l("["),l(a),h("];"),l("        "),l(s),l("tk !== -1 && _prepareToken("),l(s),h("tk);"),l("        switch("),l(a),l("){");for(var i=0,o=t.states;i<o.length;i++)if(null!==o[i].endAction&&r(o[i].endAction.data)){h(""),l("            case "),l(i),l(":");for(var u=0,c=o[i].endAction.data;u<c.length;u++){var f=c[u];-1===f.token&&f.toCode(n)}h(""),l("                break;")}h(""),h("            default:;"),h("        }"),l("    }")}h(""),h(""),h("function tokenToString(tk: number){"),l("    return "),l(s),l("tokenAlias[tk] === null ? `<${"),l(s),l('tokenNames[tk]}>` : `"${'),l(s),h('tokenAlias[tk]}"`;'),h("}"),h(""),h("class Token {"),h("    constructor("),h("        public id: number,"),h("        public val: string,"),h("        public startLine: number,"),h("        public startColumn: number,"),h("        public endLine: number,"),h("        public endColumn: number"),h("    ){}"),h("    clone(){"),h("        return new Token("),h("            this.id,"),h("            this.val,"),h("            this.startLine,"),h("            this.startColumn,"),h("            this.endLine,"),h("            this.endColumn"),h("        );"),h("    }"),h("    toString(){"),l("        return ("),l(s),h("tokenAlias[this.id] === null ? "),l("            `<${"),l(s),h("tokenNames[this.id]}>` :"),l('            `"${'),l(s),h('tokenAlias[this.id]}"`) + `("${this.val}")`;'),h("    }"),h("}"),l("interface "),l(_),h("{"),l("    init("),l(o(t.file.initArg)),h(");"),h("    accept(s: string);"),h("    end();"),h("    halt();"),h("    on(ent: string, cb: (a1?, a2?, a3?) => any);"),l("}");var x=o(t.file.sematicType,"any");h(""),l("function createParser(): "),l(_),h(" {"),h("    // members for lexer"),h("    var _lexState: number[];"),h("    var _state: number;"),h("    var _matched: string;"),h("    var _token: Token;"),h("    "),h("    var _marker: { state: number, line: number, column: number } = { state: -1, line: 0, column: 0 };"),h("    var _backupCount: number;"),h(""),h("    var _line: number;"),h("    var _column: number;"),h("    var _tline: number;"),h("    var _tcolumn: number;"),h(""),h("    // members for parser"),h("    var _lrState: number[] = [];"),l("    var _sematicS: "),l(x),h("[] = [];"),l("    var _sematicVal: "),l(x),h(";"),h(""),h("    var _stop;"),h(""),h("    var _handlers: {[s: string]: ((a1?, a2?, a3?) => any)[]} = {};"),h(""),h("    // extra members, defined by %extra_arg"),l("    "),l(o(t.file.extraArgs)),h(""),h(""),h("    "),l("    function init("),l(o(t.file.initArg)),h("){"),h("        _lexState = [ 0 ];// DEFAULT"),h("        _state = 0;"),h("        _matched = '';"),h("        _token = new Token(-1, null, 0, 0, 0, 0);"),h("        _marker.state = -1;"),h("        _backupCount = 0;"),h("        _line = _tline = 0;"),h("        _column = _tcolumn = 0;"),h("        "),h("        _lrState = [ 0 ];"),h("        _sematicS = [];"),h("        _sematicVal = null;"),h(""),h("        _stop = false;"),l("        "),l(o(t.file.initBody)),h(""),h("    }"),h("    /**"),h("     *  set "),h("     */"),h("    function _setImg(s: string){"),h("        _matched = s;"),h("        _tline = _line;"),h("        _tcolumn = _column;"),h("    }"),h("    function _prepareToken(tid: number){"),h("        _token.id = tid;"),h("        _token.val = _matched;"),h("        _token.startLine = _tline;"),h("        _token.startColumn = _tcolumn;"),h("        _token.endLine = _line;"),h("        _token.endColumn = _column - 1;"),h(""),h("        _matched = '';"),h("        _tline = _line;"),h("        _tcolumn = _column;"),h("    }"),h("    function _returnToken(){"),l("        _emit('token', "),l(s),h("tokenNames[_token.id], _token.val);"),h("        while(!_stop && !_acceptToken(_token));"),h("        _token.id = -1;"),h("    }"),h("    function _emit(name: string, a1?, a2?, a3?){"),h("        var cbs = _handlers[name];"),h("        if(cbs){"),h("            for(var i = 0; i < cbs.length; i++){"),h("                cbs[i](a1, a2, a3);"),h("            }"),h("        }"),h("    }"),h("    function on(name: string, cb: (a1?, a2?, a3?) => any){"),h("        _handlers[name] || (_handlers[name] = []);"),h("        _handlers[name].push(cb);"),l("    }");for(m=0,b=k;m<b.length;m++)A(b[m],m);h(""),h("    /**"),h("     *  do a lexical action"),h("     *  @api private"),h("     *  @internal"),h("     */"),h("    function _doLexAction(lexstate: number, state: number){"),l("        switch(lexstate){");for(m=0;m<k.length;m++)h(""),l("            case "),l(m),h(":"),l("                _doLexAction"),l(m),h("(state);"),l("                break;");h(""),h("            default:;"),h("        }"),h("        _token.id !== -1 && _returnToken();"),h("    }"),h("    function _rollback(): string{"),h("        let ret = _matched.substr(_matched.length - _backupCount, _backupCount);"),h("        _matched = _matched.substr(0, _matched.length - _backupCount);"),h("        _backupCount = 0;"),h("        _line = _marker.line;"),h("        _column = _marker.column;"),h("        _state = _marker.state;"),h("        _marker.state = -1;"),h("        return ret;"),h("    }"),h("    function _mark(){"),h("        _marker.state = _state;"),h("        _marker.line = _line;"),h("        _marker.column = _column;"),h("        _backupCount = 0;"),h("    }"),h("    function _consume(c: string){"),h("        c === '\\n' ? (_line++, _column = 0) : (_column++);"),h("        _matched += c;"),h("        _marker.state !== -1 && (_backupCount++);"),h("        return true;"),h("    }"),h("    /**"),h("     *  accept a character"),h("     *  @return - true if the character is consumed, false if not consumed"),h("     *  @api private"),h("     *  @internal"),h("     */"),h("    function _acceptChar(c: string){"),h("        var lexstate = _lexState[_lexState.length - 1];"),h("        var retn = { state: _state, hasArc: false, isEnd: false };"),l("        "),l(s),h("lexers[lexstate](c.charCodeAt(0), retn);"),h("        if(retn.isEnd){"),h("            // if current state is a terminate state, be careful"),h("            if(retn.hasArc){"),h("                if(retn.state === -1){"),h("                    // nowhere to go, stay where we are"),h("                    _doLexAction(lexstate, _state);"),h("                    // recover"),h("                    _marker.state = -1;"),h("                    _backupCount = 0;"),h("                    _state = 0;                    "),h("                    // character not consumed"),h("                    return false;"),h("                }"),h("                else {"),h("                    // now we can either go to that new state, or stay where we are"),h("                    // it is prefered to move forward, but that could lead to errors,"),h("                    // so we need to memorize this state before move on, in case if "),h("                    // an error occurs later, we could just return to this state."),h("                    _mark();"),h("                    _state = retn.state;"),h("                    return _consume(c);"),h("                }"),h("            }"),h("            else {"),h("                // current state doesn't lead to any state, just stay here."),h("                _doLexAction(lexstate, _state);"),h("                // recover"),h("                _marker.state = -1;"),h("                _backupCount = 0;"),h("                _state = 0;"),h("                // character not consumed"),h("                return false;"),h("            }"),h("        }"),h("        else {"),h("            if(retn.state === -1){"),h("                // nowhere to go at current state, error may have occured."),h("                // check marker to verify that"),h("                if(_marker.state !== -1){"),h("                    // we have a previously marked state, which is a terminate state."),h("                    var s = _rollback();"),h("                    _doLexAction(lexstate, _state);"),h("                    _state = 0;"),h("                    accept(s);"),h("                    // character not consumed"),h("                    return false;"),h("                }"),h("                else {"),h("                    // error occurs"),h("                    _emit('lexicalerror', `unexpected character \"${c}\"`, _line, _column);"),h("                    // force consume"),h("                    return true;"),h("                }"),h("            }"),h("            else {"),h("                _state = retn.state;"),h("                // character consumed"),h("                return _consume(c);"),h("            }"),h("        }"),h("    }"),h("    function _acceptEOF(){"),h("        if(_state === 0){"),h("            // recover"),h("            _prepareToken(0);"),h("            _returnToken();"),h("            return true;"),h("        }"),h("        else {"),h("            let lexstate = _lexState[_lexState.length - 1];"),h("            let retn = { state: _state, hasArc: false, isEnd: false };"),l("            "),l(s),h("lexers[lexstate](-1, retn);"),h("            if(retn.isEnd){"),h("                _doLexAction(lexstate, _state);"),h("                _state = 0;"),h("                _marker.state = -1;"),h("                return false;"),h("            }"),h("            else if(_marker.state !== -1){"),h("                let s = _rollback();"),h("                _doLexAction(lexstate, _state);"),h("                _state = 0;"),h("                accept(s);"),h("                return false;"),h("            }"),h("            else {"),h("                _emit('lexicalerror', 'unexpected end of file');"),h("                return true;"),h("            }"),h("        }"),h("    }"),h("    /**"),h("     *  input a string"),h("     *  @api public"),h("     */"),h("    function accept(s: string){"),h("        for(let i = 0; i < s.length && !_stop;){"),h("            _acceptChar(s.charAt(i)) && i++;"),h("        }"),h("    }"),h("    /**"),h("     *  tell the compiler that end of file is reached"),h("     *  @api public"),h("     */"),h("    function end(){"),h("        while(!_stop && !_acceptEOF());"),h("        _stop = true;"),h("    }"),h("    function halt(){"),h("        _stop = true;"),l("    }");h(""),l("    function _doReduction("),l(s),h("rulenum: number){"),l("        let "),l(s),l("nt = "),l(s),l("lhs["),l(s),h("rulenum];"),l("        let "),l(s),h("sp = _sematicS.length;"),l("        let "),l(s),l("top = _sematicS["),l(s),l("sp - "),l(s),l("ruleLen["),l(s),h("rulenum]] || null;"),l("        switch("),l(s),l("rulenum){"),function(){for(var e={addBlock:function(t,e){h(""),l("                {"),l(t.replace(/\$\$/g,s+"top")),l("}")},pushLexState:function(t){h(""),l("                _lexState.push("),l(t),l(");")},popLexState:function(){h(""),l("                _lexState.pop();")},setImg:function(t){h(""),l('                _setImg("'),l(t),l('");')},returnToken:function(t){h(""),h("                _token = {"),l("                    id: "),l(t.index),h(","),h("                    val: _matched.join('')"),l("                };")}},n=0,r=t.file.grammar.rules;n<r.length;n++){var a=r[n];if(null!==a.action){h(""),l("            case "),l(a.index),h(":"),l("                /* "),l(a.toString()),l(" */");for(var i in a.vars)h(""),l("                var "),l(i),l(" = _sematicS["),l(s),l("sp - "),l(a.rhs.length-a.vars[i].val),l("];");for(var o in a.usedVars)h(""),l("                var "),l(o),l(" = _sematicS["),l(s),l("sp - "),l(a.usedVars[o].val),l("];");for(var u=0,c=a.action;u<c.length;u++)c[u].toCode(e);h(""),l("                break;")}}}(),h(""),h("        }"),l("        _lrState.length -= "),l(s),l("ruleLen["),l(s),h("rulenum];"),l("        let "),l(s),h("cstate = _lrState[_lrState.length - 1];"),l("        _lrState.push("),l(s),l("pgoto["),l(s),l("disgoto["),l(s),l("cstate] + "),l(s),h("nt]);"),h(""),l("        _sematicS.length -= "),l(s),l("ruleLen["),l(s),h("rulenum];"),l("        _sematicS.push("),l(s),h("top);"),h("    }"),h(""),h("    function _acceptToken(t: Token){"),h("        // look up action table"),h("        let cstate = _lrState[_lrState.length - 1];"),l("        let ind = "),l(s),h("disact[cstate] + t.id;"),h("        let act = 0;"),l("        if(ind < 0 || ind >= "),l(s),l("pact.length || "),l(s),h("checkact[ind] !== cstate){"),l("            act = -"),l(s),h("defred[cstate] - 1;"),h("        }"),h("        else {"),l("            act = "),l(s),h("pact[ind];"),h("        }"),l("        if(act === "),l(s),h("actERR){"),h("            // explicit error"),h("            _syntaxError(t);"),h("            return true;"),h("        }"),h("        else if(act > 0){"),h("            // shift"),h("            if(t.id === 0){"),h("                // end of file"),h("                _stop = true;"),h("                _emit('accept');"),h("                return true;"),h("            }"),h("            else {"),h("                _lrState.push(act - 1);"),h("                _sematicS.push(_sematicVal);"),h("                _sematicVal = null;"),h("                // token consumed"),h("                return true;"),h("            }"),h("        }"),h("        else if(act < 0){"),h("            _doReduction(-act - 1);"),h("            return false;"),h("        }"),h("        else {"),h("            // error"),h("            _syntaxError(t);"),h("            // force consume"),h("            return true;"),h("        }"),h("    }"),h("    function _syntaxError(t: Token){"),h("        let msg = `unexpected token ${t.toString()}, expecting one of the following token(s):\\n`"),h("        msg += _expected(_lrState[_lrState.length - 1]);"),h('        _emit("syntaxerror", msg, t);'),h("    }"),h("    function _expected(state: number){"),l("        let dis = "),l(s),h("disact[state];"),h("        let ret = '';"),h("        function expect(tk: number){"),h("            let ind = dis + tk;"),l("            if(ind < 0 || ind >= "),l(s),l("pact.length || state !== "),l(s),h("checkact[ind]){"),l("                return "),l(s),h("defred[state] !== -1;"),h("            }"),h("            else {"),h("                return true;"),h("            }"),h("        }"),l("        for(let tk = 0; tk < "),l(s),h("tokenCount; tk++){"),h("            expect(tk) && (ret += `    ${tokenToString(tk)} ...` + '\\n');"),h("        }"),h("        return ret;"),h("    }"),h("    return {"),h("        init,"),h("        on,"),h("        accept,"),h("        end,"),h("        halt"),h("    };"),h("}"),l(t.file.epilogue.val)}(t,e),e.save(".ts")},Ft["typescript"]=Bt;var Bt;var Mt=Object.freeze({compress:tt,IntervalSet:f});t.Pattern=M,t.io=_,t.debug=Mt,t.setDebugger=function(t){return i.log=t.log},t.setTab=function(t){return s=t},t.genResult=function(t){for(var e,n,r,a,o=[],u=[],c=[],l=!1,h={warn:U,err:F,printItemSets:function(t){t.writeln(n.size+" state(s) in total,finished in "+r+" iteration(s)."),n.forEach(function(e){t.writeln(e.toString({showTrailer:!0}))})},printTable:function(t){!function(t,e,n){var r=e.g,a=r.tokenCount,i=r.nts.length;n.forEach(function(n){var o=n.stateIndex,u="",c="",l="";t.writeln("state "+o),n.forEach(function(e){t.writeln(s+e.toString({showTrailer:!1}))}),-1!==e.defred[o]?t.writeln(s+"default action: reduce with rule "+e.defred[o]):t.writeln(s+"no default action");for(var h=0;h<a;h++)null!==(f=e.lookupShift(o,h))&&f!==H.NULL&&(f.actionType===B.SHIFT?u+=""+s+$(r.tokens[h])+" : shift, and go to state "+f.shift.stateIndex+g:c+=""+s+$(r.tokens[h])+" : reduce with rule "+f.rule.index+g);for(h=0;h<i;h++){var f;null!==(f=e.lookupGoto(o,h))&&(l+=""+s+r.nts[h].sym+" : go to state "+f.shift.stateIndex+g)}t.writeln(u+c+l),t.writeln("")})}(t,a,n)},printDFA:function(t){for(var n=0,r=e.lexDFA;n<r.length;n++){var a=r[n];a.print(t),t.writeln(),t.writeln()}},testParse:function(t){return function(t,e,n){for(var r=[],a=0,s=n;a<s.length;a++){var i=s[a],o=void 0;if(/<[^>]+>/.test(i)){if(null===(o=t.findTokenByName(i.substr(1,i.length-2))))throw new L("cannot recognize "+i+" as a token")}else{var u=t.findTokensByAlias(i);if(0===u.length)throw new L('cannot recognize "'+i+'" as a token');if(u.length>1){for(var c="",l=0,h=u;l<h.length;l++)c+="<"+h[l].sym+"> ";throw new L('cannot recognize "'+i+'" as a token, since it can be '+c)}o=u[0]}r.push(o)}var f=[0],d=[],p=[];function v(){return f[f.length-1]}function g(t){f.push(t);var e=r.shift();d.push($(e))}function k(t){f.length-=t.rhs.length,d.length-=t.rhs.length,d.push(t.lhs.sym);var n=e.lookupGoto(v(),t.lhs.index).shift.stateIndex;f.push(n)}function m(){for(var t="",e=0,n=d;e<n.length;e++)t+=n[e]+" ";t+="| ";for(var a=0,s=r;a<s.length;a++)t+=$(s[a]),t+=" ";return t}for(p.push(m());;){var b=e.lookupShift(v(),r[0]?r[0].index:0);if(null!==b){if(b===H.NULL){p.push("syntax error!");break}if(b.actionType===B.SHIFT){if(0===r.length){p.push("accepted!");break}g(b.shift.stateIndex)}else if(b.actionType===B.REDUCE){if(k(b.rule))break}else console.assert(!1)}else{var E=e.defred[v()];if(-1===E){p.push("syntax error!");break}k(t.rules[E])}p.push(m())}return p}(e.grammar,a,t)},printError:function(t,e){for(var n=0,r=o;n<r.length;n++){var a=r[n];t.writeln(a.toString(e))}t.writeln()},printWarning:function(t,e){for(var n=0,r=u;n<r.length;n++){var a=r[n];t.writeln(a.toString(e))}t.writeln()},hasWarning:function(){return u.length>0},hasError:M,warningSummary:function(){return u.length+" warning(s), "+o.length+" error(s)"},getTemplateInput:function(){return{endl:"\n",pt:a,file:e}},requireLines:function(t){return c.push(t)},isTerminated:function(){return l}},f=function(t,e){var n=Ut(),r=!1;n.on("lexicalerror",function(e,a,s){t.requireLines(function(t,n){var r,i,o=e+" "+it((r=a,i=s,{startLine:r,startColumn:i,endLine:r,endColumn:i}),n);t.err(new L(o,"LexicalError"))}),n.halt(),r=!0}),n.on("syntaxerror",function(e,a){t.requireLines(function(t,n){var r=it(a,n)+g+e;t.err(new L(r,"SyntaxError"))}),n.halt(),r=!0});var a=pt(t);return n.init(t,a),n.accept(e),n.end(),r?null:a.build()}(h,t),d=t.split("\n"),p=0,v=c;p<v.length;p++)(0,v[p])(h,d);if(M())return l=!0,h;var k=f.grammar;e=f;for(var m=0,b=k.tokens;m<b.length;m++){var E=b[m];if(!E.used){for(var _="token <"+E.sym+"> is never used, definations are(is):"+g,A=0,x=E.appears;A<x.length;A++)_+=it(x[A],d);U(new I(_))}}for(var y=0,S=k.nts;y<S.length;y++){var w=S[y];w.used||U(new I('non terminal "'+w.sym+'" is unreachable'))}T=f.output.val,void 0===Ft[T]&&F(new L("template for '"+f.output.val+"' is not implemented yet "+it(f.output,d)));var T;if(M())return l=!0,h;k.genFirstSets();var C=X(k);n=C.result,r=C.iterations;var R=function(t,e){var n=[];function r(e,r,a){var s=t.tokens[r.getShift()];if(s.assoc!==G.UNDEFINED){var o=a.rule.pr;if(-1!==o){if(o>s.pr)return a;if(o<s.pr)return r;if(s.assoc===G.LEFT)return a;if(s.assoc===G.RIGHT)return r;if(s.assoc===G.NON)return H.NULL;i.assert(!1)}}var u=new Q;return u.type=q.SR,u.set=e,u.token=s,u.used=r,u.discarded=a,n.push(u),r}function a(e,r,a,s){var i=t.tokens[s];if(-1!==r.rule.pr&&-1!==a.rule.pr&&r.rule.pr!==a.rule.pr)return r.rule.pr>a.rule.pr?r:a;var o=r.rule.index>a.rule.index?a:r,u=r.rule.index>a.rule.index?r:a,c=new Q;return c.type=q.RR,c.set=e,c.token=i,c.used=o,c.discarded=u,n.push(c),o}var s=new W(t,e.size);return e.forEach(function(e){e.forEach(function(n){if(n.actionType===B.SHIFT){var o=n.getShift();if(t.isToken(o)){var u=e.stateIndex*t.tokenCount+o;null!==(l=s.shift[u])?l.actionType===B.REDUCE?s.shift[u]=r(e,n,l):i.assert(l.shift===n.shift):s.shift[u]=n}else u=e.stateIndex*t.nts.length+(-o-1),s.gotot[u]=n}else if(n.actionType===B.REDUCE){for(var c=0;c<t.tokenCount;c++)if(n.lah.contains(c+1)){var l,h=e.stateIndex*t.tokenCount+c;null!==(l=s.shift[h])?l.actionType===B.REDUCE?s.shift[h]=a(e,l,n,c):l.actionType===B.SHIFT&&(s.shift[h]=r(e,l,n)):s.shift[h]=n}}else i.assert(!1)})}),{result:s,conflicts:n}}(k,n);R.result.findDefAct(),a=new nt(R.result);for(var N=0,D=R.conflicts;N<D.length;N++){var O=D[N];U(new I(O.toString()))}return h;function U(t){u.push(t)}function F(t){o.push(t)}function M(){return o.length>0}},t.generateCode=function(t,e,n,r){if(void 0===Ft[t])throw'template for language "'+t+'" is not implemented yet';Ft[t](e,n)},Object.defineProperty(t,"__esModule",{value:!0})});
