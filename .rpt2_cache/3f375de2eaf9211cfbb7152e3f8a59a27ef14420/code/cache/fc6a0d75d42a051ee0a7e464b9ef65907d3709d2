{"code":"import { genItemSets, genParseTable } from '../grammar/ptable-gen';\r\nimport { parseSource } from '../parser/gparser';\r\nimport { testParse } from './parse-test';\r\nimport { YYTAB } from '../util/common';\r\nvar Result = (function () {\r\n    function Result() {\r\n        this.unusedTokens = [];\r\n        this.unusedNts = [];\r\n    }\r\n    Result.prototype.printItemSets = function (stream) {\r\n        stream.writeln(this.itemSets.size + ' state(s) in total,finished in ' + this.iterationCount + ' iteration(s).');\r\n        this.itemSets.forEach(function (s) {\r\n            stream.writeln(s.toString({ showTrailer: true }));\r\n        });\r\n    };\r\n    Result.prototype.printTable = function (stream) {\r\n        this.parseTable.summary(this.itemSets, stream);\r\n    };\r\n    Result.prototype.testParse = function (tokens) {\r\n        return testParse(this.file.grammar, this.parseTable, tokens);\r\n    };\r\n    Result.prototype.warningMsg = function () {\r\n        var ret = '';\r\n        if (this.unusedTokens.length > 0) {\r\n            ret += 'unused tokens:\\n';\r\n            for (var _i = 0, _a = this.unusedTokens; _i < _a.length; _i++) {\r\n                var t = _a[_i];\r\n                ret += YYTAB + '\"' + t.sym + '\" (defined at line ' + t.line + ')\\n';\r\n            }\r\n        }\r\n        if (this.unusedNts.length > 0) {\r\n            ret += 'unused non terminals:\\n';\r\n            for (var _b = 0, _c = this.unusedNts; _b < _c.length; _b++) {\r\n                var t2 = _c[_b];\r\n                ret += YYTAB + t2.sym + '\\n';\r\n            }\r\n        }\r\n        for (var _d = 0, _e = this.conflicts; _d < _e.length; _d++) {\r\n            var cf = _e[_d];\r\n            ret += cf.toString() + '\\n';\r\n        }\r\n        return ret;\r\n    };\r\n    return Result;\r\n}());\r\nfunction genResult(stream) {\r\n    var result = new Result();\r\n    var f = parseSource(stream);\r\n    var g = f.grammar;\r\n    g.genFirstSets();\r\n    result.file = f;\r\n    var temp = genItemSets(g);\r\n    result.itemSets = temp.result;\r\n    result.iterationCount = temp.iterations;\r\n    var temp2 = genParseTable(g, result.itemSets);\r\n    result.parseTable = temp2.result;\r\n    result.conflicts = temp2.conflicts;\r\n    for (var _i = 0, _a = g.tokens; _i < _a.length; _i++) {\r\n        var s = _a[_i];\r\n        if (!s.used) {\r\n            result.unusedTokens.push(s);\r\n        }\r\n    }\r\n    for (var _b = 0, _c = g.nts; _b < _c.length; _b++) {\r\n        var s2 = _c[_b];\r\n        if (!s2.used) {\r\n            result.unusedNts.push(s2);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nexport { genResult };\r\n//# sourceMappingURL=result.js.map","map":{"version":3,"file":"result.js","sourceRoot":"","sources":["../src/top/result.ts"],"names":[],"mappings":"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"}}
